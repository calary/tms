!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r=n(1),i=n(2),s=n(29),o=n(51),a=n(60),l=n(71),d={states:[],constants:{},components:{},directives:{},services:{},factories:{},filters:{},configBlocks:[],runBlocks:[]},c=[i,s,o,a,l].map(function(t){return Object.assign({},d,t)});c.forEach(function(t){r.config(["$stateProvider",function(e){return t.states.forEach(function(t){return e.state(t)})}]),Object.keys(t.constants).forEach(function(e){return r.constant(e,t.constants[e])}),Object.keys(t.components).forEach(function(e){return r.component(e,t.components[e])}),Object.keys(t.directives).forEach(function(e){return r.directive(e,t.directives[e])}),Object.keys(t.services).forEach(function(e){return r.service(e,t.services[e])}),Object.keys(t.factories).forEach(function(e){return r.factory(e,t.factories[e])}),Object.keys(t.filters).forEach(function(e){return r.filter(e,t.filters[e])}),t.configBlocks.forEach(function(t){return r.config(t)}),t.runBlocks.forEach(function(t){return r.run(t)})})},function(t,e){t.exports=angular.module("app",["ngAnimate","ngMessages","ngSanitize","ui.bootstrap","ui.select","ui.router","uiSwitch","formly","formlyBootstrap"])},function(t,e,n){var r=n(3);t.exports={runBlocks:[r.runFormlyConfig]}},function(t,e,n){n(4),e.runFormlyConfig=["formlyConfig","formlyValidationMessages",function(t,e){t.setWrapper(n(8)),t.setWrapper(n(10)),t.setWrapper(n(12)),t.setType(n(14)),t.setType(n(15)),t.setType(n(16)),t.setType(n(17)),t.setType(n(18)),t.setType(n(19)),t.setType(n(20)),t.setType(n(21)),t.setType(n(23)),t.setType(n(25)),t.setType(n(26)),t.setType(n(28)),t.extras.errorExistsAndShouldBeVisibleExpression="fc.$touched || form.$submitted",t.extras.ngModelAttrsManipulatorPreferBound=!0,e.addStringMessage("required","必填"),e.addStringMessage("maxlength","输入太长了"),e.messages.pattern=function(t,e,n){return t+" is invalid"},e.addTemplateOptionValueMessage("minlength","minlength","","is the minimum length","Too short")}]},function(t,e){},,,,function(t,e,n){t.exports={name:"bootstrapHasError",template:n(9),overwriteOk:!0}},function(t,e){t.exports='<div class="formly-template-wrapper form-group" ng-class="{\'has-error\': showError}">\r\n  <formly-transclude></formly-transclude>\r\n  <div class="validation"\r\n    ng-if="fc.$touched || form.$submitted"\r\n    ng-messages="fc.$error">\r\n    <div ng-message="{{::name}}" ng-repeat="(name, message) in ::options.validation.messages">\r\n    \t<span class="glyphicon glyphicon-exclamation-sign"></span>\r\n      {{message(fc.$viewValue, fc.$modelValue, this)}}\r\n    </div>\r\n  </div>\r\n</div>'},function(t,e,n){t.exports={name:"horizontalBootstrapWrapper",template:n(11)}},function(t,e){t.exports='<div class="col-sm-4"></div>\r\n<div class="col-sm-8">\r\n  <formly-transclude></formly-transclude>\r\n</div>'},function(t,e,n){t.exports={name:"horizontalBootstrapLabel",template:n(13)}},function(t,e){t.exports='<label for="{{::id}}" class="col-xs-4 control-label">\r\n  {{to.label}}\r\n</label>\r\n<div class="col-xs-8">\r\n  <formly-transclude></formly-transclude>\r\n</div>'},function(t,e){t.exports={name:"checkbox2",extends:"checkbox",wrapper:["horizontalBootstrapWrapper","bootstrapHasError"]}},function(t,e){t.exports={name:"input2",extends:"input",wrapper:["horizontalBootstrapLabel","bootstrapHasError"]}},function(t,e){t.exports={name:"plainTimeRange",template:'<datetime-range ng-model="model[options.key]"></datetime-range>',defaultOptions:{ngModelAttrs:{mode:{bound:"mode",attribute:"mode"}}}}},function(t,e){t.exports={name:"timeRange",extends:"plainTimeRange",wrapper:["bootstrapLabel","bootstrapHasError"]}},function(t,e){t.exports={name:"timeRange2",extends:"plainTimeRange",wrapper:["horizontalBootstrapLabel","bootstrapHasError"]}},function(t,e){t.exports={name:"select2",extends:"select",wrapper:["horizontalBootstrapLabel","bootstrapHasError"]}},function(t,e){t.exports={name:"static2",template:'<p class="form-control-static">{{to.text}}</p>',wrapper:["horizontalBootstrapLabel","bootstrapHasError"],defaultOptions:{noFormControl:!0}}},function(t,e,n){var r=1;t.exports={name:"repeatSection",template:n(22),controller:function(t){function e(t){return t=angular.copy(t),i(t),t}function n(){t.model[t.options.key]=t.model[t.options.key]||[];var e=t.model[t.options.key],n=e[e.length-1],r={};n&&(r=angular.copy(n)),e.push(r)}function i(t){r++,angular.forEach(t,function(t,e){return t.fieldGroup?void i(t.fieldGroup):(t.templateOptions&&t.templateOptions.fields&&i(t.templateOptions.fields),void(t.id=t.id||t.key+"_"+e+"_"+r+s(0,9999)))})}function s(t,e){return Math.floor(Math.random()*(e-t))+t}t.formOptions={formState:t.formState},t.addNew=n,t.copyFields=e}}},function(t,e){t.exports='<div>\r\n  <!--loop through each element in model array-->\r\n  <div class="{{hideRepeat}}">\r\n    <div class="repeatsection" ng-repeat="element in model[options.key]" ng-init="fields = copyFields(to.fields)">\r\n      <formly-form fields="fields"\r\n                   model="element"\r\n                   form="form">\r\n      </formly-form>\r\n      <div style="margin-bottom:20px;">\r\n        <button type="button" class="btn btn-sm btn-danger" ng-click="model[options.key].splice($index, 1)">\r\n          Remove\r\n        </button>\r\n      </div>\r\n      <hr>\r\n  </div>\r\n  <p class="AddNewButton">\r\n    <button type="button" class="btn btn-primary" ng-click="addNew()" >{{to.btnText}}</button>\r\n  </p>\r\n</div>'},function(t,e,n){t.exports={name:"uiSelect",wrapper:["bootstrapLabel","bootstrapHasError"],template:n(24)}},function(t,e){t.exports='<ui-select ng-model="model[options.key]" required="{{to.required}}" disabled="{{to.disabled}}" search-enabled="false" theme="bootstrap">\r\n  <ui-select-match placeholder="{{to.placeholder}}" allow-clear="true">{{$select.selected[to.labelProp || \'name\']}}</ui-select-match>\r\n  <ui-select-choices group-by="to.groupBy" repeat="option[to.valueProp || \'value\'] as option in to.options">\r\n    <div ng-bind-html="option[to.labelProp] | highlight: $select.search"></div>\r\n  </ui-select-choices>\r\n</ui-select>'},function(t,e,n){t.exports={name:"uiSelect2",wrapper:["horizontalBootstrapLabel","bootstrapHasError"],template:n(24)}},function(t,e,n){t.exports={name:"uiSelectAsync",wrapper:["bootstrapLabel","bootstrapHasError"],template:n(27)}},function(t,e){t.exports='<ui-select ng-model="model[options.key]" required="{{to.required}}" disabled="{{to.disabled}}" theme="bootstrap" spinner-enabled="true">\r\n  <ui-select-match placeholder="{{to.placeholder}}">{{$select.selected[to.labelProp || \'name\']}}</ui-select-match>\r\n  <ui-select-choices repeat="option[to.valueProp || \'value\'] as option in to.options" refresh="to.refresh($select.search, options)" refresh-delay="{{to.refreshDelay}}">\r\n    <div ng-bind-html="option[to.labelProp] | highlight: $select.search"></div>\r\n  </ui-select-choices>\r\n  <ui-select-no-choices>无匹配结果</ui-select-no-choices>\r\n</ui-select>'},function(t,e,n){t.exports={name:"uiSelectAsync2",wrapper:["horizontalBootstrapLabel","bootstrapHasError"],template:n(27)}},function(t,e,n){var r=n(30),i=n(32),s=n(36),o=n(37),a=n(38),l=n(39),d=n(40),c=n(43),u=n(47),p=n(49);t.exports={components:{baseModal:r,datetimeModal:i},directives:{inputFile:d,datetimePicker:c,datetimeRange:u},factories:{$modalService:s,$datetimeModalService:o,dateService:a},filters:{date2:l},runBlocks:[p.cacheTemplateRunBlock,p.runFormlyConfig]}},function(t,e,n){function r(t){function e(){if(r.handleOk){if(r.lock)return;r.lock=!0,r.handleOk().then(function(){r.close()}).finally(function(){r.lock=!1})}else r.close()}function n(){r.dismiss()}var r=this,i=r.resolve.config;console.log(i),r.title=i.title||"",r.content=i.content||"",r.okLabel=i.okLabel||"确定",r.cancelLabel=i.cancelLabel||"取消",r.hideOk=i.hideOk||!1,r.hideCancel=i.hideCancel||!1,r.handleOk=i.handleOk||null,r.isToast=i.isToast||null,r.timeout=i.timeout||3e3,r.ok=e,r.cancel=n,r.lock=!1,r.isToast&&t(n,vm.timeout)}r.$inject=["$timeout"],t.exports={template:n(31),controller:r,bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(t,e){t.exports='<div class="modal-header bg-primary" ng-show="$ctrl.title" >\r\n\t<button type="button" class="close" ng-click="$ctrl.cancel();"><span>&times;</span></button>\r\n    <h4 class="modal-title" ng-bind-html="$ctrl.title"></h4>\r\n</div>\r\n<div class="modal-body" ng-class="{\'modal-toast\': $ctrl.isToast}">\r\n    <div ng-bind-html="$ctrl.content"></div>\r\n</div>\r\n<div class="modal-footer" ng-hide="$ctrl.isToast">\r\n    <button class="btn btn-primary" type="button" ng-disabled="$ctrl.lock" ng-hide="$ctrl.hideOk" ng-click="$ctrl.ok();">{{ $ctrl.okLabel }}</button>\r\n    <button class="btn btn-default" type="button" ng-hide="$ctrl.hideCancel" ng-click="$ctrl.cancel();">{{ $ctrl.cancelLabel }}</button>\r\n</div>'},function(t,e,n){function r(t){function e(){r.close({$value:r.date})}function n(){r.dismiss()}var r=this;r.ok=e,r.cancel=n;var i=r.resolve.config,s=i.date?angular.copy(i.date):new Date,o=i.minDate?angular.copy(i.minDate):null,a=i.maxDate?angular.copy(i.maxDate):null,l=i.mode?i.mode.toLowerCase():"datetime",d="time"===l||"datetime"===l?"day":l;r.showDate="time"!==l,r.showTime="datetime"===l||"time"===l,r.date=s,r.options={showWeeks:!1,minDate:o,maxDate:a,minMode:d},t.$watch("$ctrl.date",function(t){o&&o.getTime()>=r.date.getTime()&&r.date.setTime(o.getTime()+1e3),a&&a.getTime()<=r.date.getTime()&&r.date.setTime(a.getTime()-1e3)})}n(33),r.$inject=["$scope"],t.exports={template:n(35),controller:r,bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(t,e){},,function(t,e){t.exports='<div class="modal-header bg-default">\r\n\t<button type="button" class="close" ng-click="$ctrl.dismiss();"><span>&times;</span></button>\r\n    <h4 class="modal-title">选择时间</h4>\r\n</div>\r\n<div class="modal-body">\r\n  <div uib-datepicker \r\n    ng-model="$ctrl.date" \r\n    ng-show="$ctrl.showDate"\r\n    datepicker-options="$ctrl.options"></div>\r\n  <div uib-timepicker \r\n    ng-model="$ctrl.date"\r\n    ng-show="$ctrl.showTime"\r\n    readonly-input="true"\r\n    show-meridian="false"\r\n    template-url="global/datetime-modal.timepicker.html"\r\n    show-seconds="true"></div>\r\n<!--   <div>当前时间{{ $ctrl.date | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最小日期{{ $ctrl.options.minDate | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最大日期{{ $ctrl.options.maxDate | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最小时间{{ $ctrl.minTime | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最大时间{{ $ctrl.maxTime | date:\'yyyy-MM-dd HH:mm:ss\' }}</div> -->\r\n</div>\r\n<div class="modal-footer">\r\n  <button class="btn btn-primary" type="button" ng-click="$ctrl.ok();">确定</button>\r\n  <button class="btn btn-default" type="button" ng-click="$ctrl.dismiss();">取消</button>\r\n</div>'},function(t,e){t.exports=["$uibModal",function(t){function e(e){var n=t.open({size:"sm",component:"baseModal",resolve:{config:function(){return e}}});return n.result}function n(t){return t=t||{},t.hideCancel=!0,e(t)}function r(t){return t=t||{},t.isToast=!0,e(t)}return{confirm:e,alert:n,toast:r}}]},function(t,e){t.exports=["$uibModal",function(t){function e(e){var n=t.open({size:"sm",component:"datetimeModal",windowClass:"datetime-modal",resolve:{config:e||{}}});return n.result}return{show:e}}]},function(t,e){t.exports=function(){function t(){var t=new Date;return 60*t.getTimezoneOffset()*1e3}function e(t){return i.test(t)}function n(t){if(e(t)){var n=new Date(t);return new Date(n.getTime()+s)}}function r(t){if(t instanceof Date){var e=new Date(t.getTime()-s);return e.toISOString().substr(0,19)}}var i=/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d/,s=t();return{isDateString:e,fromString:n,toString:r}}},function(t,e){t.exports=["$filter","dateService",function(t,e){return function(e){return t("date")(e,"yyyy-MM-dd HH:mm:ss")}}]},function(t,e,n){function r(t){var e=document.createElement("form"),n=document.createElement("div"),r=t.parentNode;r.replaceChild(n,t),e.appendChild(t),e.reset(),r.replaceChild(t,n)}function i(){return console.log("wa"),{retrict:"AE",scope:{onChange:"&"},transclude:!0,template:["<span ng-transclude></span>",'<input type="file">'].join(""),link:function(t,e,n){function i(e){var n=e.target.files;n.length>0&&(t.onChange({file:n[0]}),r(e.target))}var s=e.find("input");s.bind("change",i)}}}n(41),i.$inject=[],t.exports=i},function(t,e){},,function(t,e,n){function r(t){return{retrict:"AE",scope:{minDate:"=",maxDate:"=",mode:"@"},require:"ngModel",template:n(46),link:function(e,n,r,i){function s(t){if(t&&!(t instanceof Date))try{t=new Date(t)}catch(t){}return t}var o,a=e.mode;switch(a){case"year":o="yyyy年";break;case"month":o="yyyy-MM";break;case"day":o="yyyy-MM-dd";break;case"time":o="HH:mm:ss";break;default:o="yyyy-MM-dd HH:mm:ss"}e.format=o,e.selectTime=function(){t.show({date:s(e.date),minDate:s(e.minDate),maxDate:s(e.maxDate),mode:e.mode}).then(function(t){i.$setViewValue(t),i.$render()})},i.$render=function(){e.date=i.$viewValue};var l=!1;r.$observe("required",function(t){l=t===!0||"true"===t,i.$validate()}),i.$validators.required=function(t){return!l||!!t}}}}n(44),r.$inject=["$datetimeModalService"],t.exports=r},function(t,e){},,function(t,e){t.exports='<div class="input-group">\r\n    <p class="form-control">{{ date | date:format }}</p>\r\n    <span class="input-group-btn">\r\n      <button class="btn btn-default" type="button" ng-click="selectTime()">\r\n        <span class="glyphicon glyphicon-calendar"></span>\r\n      </button>\r\n    </span>\r\n  </div>\r\n</div>'},function(t,e,n){function r(t){return{retrict:"AE",require:"ngModel",scope:{mode:"@"},template:n(48),link:function(t,e,n,r){t.$watch("minDate+maxDate",function(){var e=t.minDate,n=t.maxDate;e&&e instanceof String&&(t.minDate=new Date(e)),n&&n instanceof String&&(t.maxDate=new Date(n)),r.$setViewValue({min:t.minDate,max:t.maxDate})}),r.$render=function(){var e=r.$isEmpty(r.$viewValue)?{}:r.$viewValue;t.minDate=e.min,t.maxDate=e.max};var i=!1;n.$observe("required",function(t){i=t===!0||"true"===t,r.$validate()}),r.$validators.required=function(t){return!i||!!(t&&t.min&&t.max)}}}}n(44),r.$inject=["$datetimeModalService"],t.exports=r},function(t,e){t.exports='<div class="datetime-range">\r\n  <datetime-picker \r\n    class="datetime-range-start"\r\n    ng-model="minDate"\r\n    max-date="maxDate"\r\n    mode="{{mode}}"\r\n  ></datetime-picker>\r\n  <div class="datetime-range-divider" style="line-height: 34px;"> 至 </div>\r\n  <datetime-picker \r\n    class="datetime-range-end"\r\n    ng-model="maxDate"\r\n    min-date="minDate"\r\n    mode="{{mode}}"\r\n  ></datetime-picker>\r\n</div>\r\n'},function(t,e,n){e.cacheTemplateRunBlock=["$templateCache",function(t){t.put("global/datetime-modal.timepicker.html",n(50))}]},function(t,e){t.exports='<table class="uib-timepicker">\r\n  <tbody>\r\n    <tr>\r\n      <td rowspan="2" class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\r\n        <input type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\r\n      </td>\r\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn" ng-disabled="noIncrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td rowspan="2" class="uib-time-name">时</td>\r\n      <td rowspan="2" class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\r\n        <input type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\r\n      </td>\r\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn" ng-disabled="noIncrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td rowspan="2" class="uib-time-name">分</td>\r\n      <td rowspan="2" class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\r\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td rowspan="2" ng-show="showSeconds" class="uib-time-name">秒</td>\r\n      <td rowspan="2" ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\r\n    </tr>\r\n    <tr>\r\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n    </tr>\r\n    <!-- <tr class="text-center" ng-show="::showSpinners">\r\n      \r\n      \r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr>\r\n    <tr>\r\n    \r\n\r\n      <td ng-show="showSeconds" class="uib-separator">:</td>\r\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\r\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\r\n    </tr>\r\n    <tr class="text-center" ng-show="::showSpinners">\r\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td>&nbsp;</td>\r\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr> -->\r\n  </tbody>\r\n</table>\r\n\r\n<!-- \r\n\r\n<table class="uib-timepicker">\r\n  <tbody>\r\n    <tr class="text-center" ng-show="::showSpinners">\r\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn btn-link" ng-disabled="noIncrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td>&nbsp;</td>\r\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn btn-link" ng-disabled="noIncrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr>\r\n    <tr>\r\n      <td class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\r\n        <input type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\r\n      </td>\r\n      <td class="uib-separator">:</td>\r\n      <td class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\r\n        <input type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showSeconds" class="uib-separator">:</td>\r\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\r\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\r\n    </tr>\r\n    <tr class="text-center" ng-show="::showSpinners">\r\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td>&nbsp;</td>\r\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n -->'},function(t,e,n){var r=n(52),i=n(54),s=n(55),o=n(56),a=n(57);n(58),t.exports={constants:{store:i.store,apiBaseUrl:i.apiBaseUrl,rulesTypes:i.rulesTypes,ruleTypes:i.ruleTypes,taskStatus:i.taskStatus,boolOptions:i.boolOptions,timeOptions:i.timeOptions,compareOptions:i.compareOptions,sexOptions:i.sexOptions,pointsOptions:i.pointsOptions,couponOptions:i.couponOptions},components:{app:r},filters:{taskStatusFilter:a.taskStatusFilter},states:[s.appState],configBlocks:[o.otherwiseConfigBlock,o.httpConfigBlock],runBlocks:[]}},function(t,e,n){function r(t,e,n){function r(){var e=t.is("newRules")||t.is("newRuleList")||t.is("newRule");i.isNewRules=e}var i=this;i.$state=t,i.store=n,i.isNewRules=!1,e.onSuccess({},function(){r()}),r()}r.$inject=["$state","$transitions","store"],t.exports={template:n(53),controller:r}},function(t,e){t.exports='<div class="app-main">\r\n  <div class="app-main-nav">\r\n    <h1 class="page-title">任务管理</h1>\r\n<!--     <p>\r\n      <label>\r\n        <input type="checkbox" ng-model="$ctrl.store.hideEditArea">隐藏\r\n      </label>\r\n    </p> -->\r\n    <ul class="nav nav-pills nav-stacked">\r\n      <li ui-sref-active="active"><a ui-sref="tasksList">任务列表</a></li>\r\n      <li ui-sref-active="active"><a ui-sref="newTask">新建任务</a></li>\r\n      <li ui-sref-active="active"><a ui-sref="rulesList">规则组列表</a></li>\r\n      <li ui-sref-active="active"><a ui-sref="viewRulesList">执行期规则组</a></li>\r\n      <li ng-class="{\'active\': $ctrl.isNewRules}" ng-hide="$ctrl.store.hideEditArea"><a ui-sref="newRules">新建规则组</a></li>\r\n      <li ui-sref-active="active"><a ui-sref="importRules">导入规则组</a></li>\r\n      <li ui-sref-active="active" ng-hide="$ctrl.store.hideEditArea"><a ui-sref="test">测试</a></li>\r\n    </ul>\r\n  </div>\r\n  <div class="app-main-content">\r\n    <h1 class="page-title">{{$ctrl.$state.$current.title}}</h1>\r\n    <ui-view class="app-ui-view"></ui-view>\r\n  </div>\r\n</div>'},function(t,e){e.store={hideEditArea:!0},e.apiBaseUrl="http://dmp.arlakitchen.com",e.rulesTypes=[{id:"网站",title:"网站",types:[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}]},{id:"广告",title:"广告",types:[{id:1,title:"广告主题/特征"},{id:2,title:"广告曝光量"},{id:3,title:"广告点击量"},{id:4,title:"广告投放媒体"}]},{id:"呼叫中心",title:"呼叫中心",types:[{id:1,title:"电话归属地"},{id:2,title:"呼入手机号"},{id:3,title:"呼入手机号运营商"},{id:4,title:"呼入时段"},{id:5,title:"呼叫内容关键字"}]},{id:"社会化媒体",title:"社会化媒体",types:[]}],e.ruleTypes=[{id:1,title:"网站",types:[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}]},{id:2,title:"网站",types:[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}]}],e.ruleTypes=[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}],e.taskStatus=[{id:0,title:"未开始"},{id:1,title:"执行中"},{id:2,title:"暂停中"},{id:3,title:"已结束"},{id:4,title:"未加入"}],e.boolOptions=[{id:1,title:"震"},{id:2,title:"假"}],e.timeOptions=[{id:1,title:"开始时间"},{id:2,title:"结束时间"}],e.compareOptions=[{id:1,title:"大于"},{id:2,title:"小于等于"},{id:2,title:"小于"},{id:2,title:"小于等于"},{id:3,title:"等于"}],e.sexOptions=[{id:1,title:"男"},{id:2,title:"女"},{id:3,title:"保密"}],e.pointsOptions=[{id:1,title:"购买积分"},{id:2,title:"行为积分"}],e.couponOptions=[{id:1,title:"领取优惠券"},{id:2,title:"使用优惠券"}]},function(t,e){e.appState={name:"app",redirectTo:"tasksList",component:"app"}},function(t,e){e.otherwiseConfigBlock=["$urlRouterProvider",function(t){t.otherwise("/task")}],e.httpConfigBlock=["$httpProvider","dateServiceProvider",function(t,e){function n(t,e,r){if(e(t))return r(t);if(angular.isObject(t)){var i;return i=angular.isArray(t)?[]:{},angular.forEach(t,function(t,s){i[s]=n(t,e,r)}),i}return t}var r=e.$get();t.defaults.transformRequest=function(t,e){var n,r,i=[];for(n in t)r=t[n],i.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return i.join("&")},t.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"},t.interceptors.push(["$q",function(t){return{request:function(t){var e=/^http/.test(t.url);return e?(console.log(t),t.params=n(t.params,angular.isDate,r.toString),t.data=n(t.data,angular.isDate,r.toString),t):t},response:function(e){var i=/^http/.test(e.config.url);if(!i)return e;var s=e.data,o=s&&s.Status,a=s&&s.Information,l=s&&s.Data||{};return 1==o?(console.log(l),l=n(l,r.isDateString,r.fromString),l.Information=a,t.resolve(l)):t.reject(a)}}}])}]},function(t,e){e.taskStatusFilter=["taskStatus",function(t){return function(e){if(!e)return"";var n=t.find(function(t){return t.id==e});return n&&n.title}}]},function(t,e){},,function(t,e,n){var r=n(61),i=n(65),s=n(67),o=n(69),a=n(70);t.exports={components:{taskList:r,editTask:i,test:s},states:[o.taskListState,o.newTaskState,o.editTaskState,o.testState],factories:{tasksService:a.tasksService}}},function(t,e,n){function r(t,e,n,r){function i(){var e=s.model.timeOption,r=s.model.time||{},i={siteid:s.model.siteid,rulegroupname:s.model.rulegroupname,rulegrouptype:s.model.rulegrouptype,status:s.model.status,startdate:0==e&&r.min||null,startdate1:0==e&&r.max||null,enddate:1==e&&r.min||null,enddate1:1==e&&r.max||null};t.getTasks(i).then(function(t){s.data=t&&t.Data||[],s.data.forEach(function(t){var e=n.find(function(e){return e.id==t.Status});e&&(t.StatusTitle=e.title)})},function(t){console.log(t)})}var s=this;s.data=[],s.filter=i,s.store=r;var o=n.slice(0,-1);s.model={timeOption:0},s.options={},s.fields=[{className:"row",fieldGroup:[{key:"siteid",type:"input2",className:"col-sm-6 col-lg-3",templateOptions:{label:"site ID/广告ID"}},{key:"rulegroupname",type:"input2",className:"col-sm-6 col-lg-3",templateOptions:{label:"规则组名称"}},{key:"rulegrouptype",type:"select2",className:"col-sm-6 col-lg-3",templateOptions:{label:"规则组类型",valueProp:"id",labelProp:"title",options:[{id:void 0,title:"全部"}].concat(e)}},{key:"status",type:"select2",className:"col-sm-6 col-lg-3",templateOptions:{label:"任务状态",valueProp:"id",labelProp:"title",options:[{id:void 0,title:"全部"}].concat(o)}}]},{className:"row",fieldGroup:[{key:"timeOption",type:"select",className:"col-sm-2",templateOptions:{label:"",valueProp:"id",labelProp:"title",options:[{id:0,title:"开始时间"},{id:1,title:"结束时间"}]}},{key:"time",type:"timeRange",className:"col-sm-8 col-md-6 pl30",templateOptions:{label:""}}]}],i()}n(62),r.$inject=["tasksService","rulesTypes","taskStatus","store"],t.exports={template:n(64),controller:r}},function(t,e){},,function(t,e){t.exports='<div class="task-list">\r\n  <!-- 筛选 -->\r\n  <div class="well well-default">\r\n    <form class="form-horizontal" name="$ctrl.form" novalidate>\r\n      <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n      </formly-form>\r\n      <button class="btn btn-primary" ng-click="$ctrl.filter()">筛选</button>\r\n      <button class="btn btn-default" ng-click="$ctrl.options.resetModel()">重置</button>  \r\n    </form>\r\n    <!-- <div>{{ $ctrl.model | json }}</div> -->\r\n  </div>\r\n  <p><a ui-sref="newTask" class="btn btn-primary">新建任务</a></p>\r\n  <!-- 任务列表 -->\r\n  <table class="table table-bordered table-hover">\r\n    <thead class="bg-default">\r\n      <tr>\r\n        <td>site ID/广告ID</td>\r\n        <td>规则组名称</td>\r\n        <td>规则组类型</td>\r\n        <td>开始时间</td>\r\n        <td>结束时间</td>\r\n        <td>状态</td>\r\n        <td ng-hide="$ctrl.store.hideEditArea">任务进度</td>\r\n        <td>创建时间</td>\r\n        <td>操作</td>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="row in $ctrl.data">\r\n        <td>{{ row.SiteID }}</td>\r\n        <td>{{ row.RuleGroupName }}</td>\r\n        <td>{{ row.RuleGroupType }}</td>\r\n        <td>{{ row.StartDate | date2 }}</td>\r\n        <td>{{ row.EndDate | date2 }}</td>\r\n        <td>\r\n          {{ row.StatusTitle }}\r\n          <span  ng-hide="$ctrl.store.hideEditArea" ng-if="row.Status==1 || row.Status==2">\r\n            <switch name="enabled" ng-model="enabled" class="green"></switch></div>\r\n          </span>\r\n        </td>\r\n        <td ng-hide="$ctrl.store.hideEditArea">\r\n          <div class="text-center">22%</div>\r\n          <uib-progressbar value="22"></uib-progressbar>\r\n        </td>\r\n        <td>{{ row.CreateTime | date2 }}</td>\r\n        <td>\r\n          <a ui-sref="editTask({taskId: row.TaskID})">编辑任务时间</a>\r\n        </td>\r\n      </tr>\r\n      <tr ng-if="!$ctrl.data.length" class="text-center">\r\n        <td colspan="9">空</td>\r\n      </tr>\r\n    </tbody>\r\n  </table> \r\n<!--   <div ng-init="bigTotalItems=175;bigCurrentPage=1;maxSize=3;"></div>\r\n  <ul uib-pagination \r\n    total-items="bigTotalItems" \r\n    ng-model="bigCurrentPage" \r\n    max-size="maxSize" \r\n    boundary-link-numbers="true" \r\n    previous-text="上一页" next-text="下一页"\r\n  ></ul> --> \r\n</div>\r\n\r\n';
},function(t,e,n){function r(t,e,n,t){function r(){if(!s.form.$invalid){var e={RuleGroupID:s.model.RuleGroupID,TaskID:s.model.TaskID,SiteID:s.model.SiteID,StartDate:s.model.time.min,EndDate:s.model.time.max};console.log(e),a?n.createTask(e).then(function(e){t.alert({content:"创建成功",hideCancel:!0}).then(i)},function(e){t.alert({content:e})}):n.editTask(e).then(function(e){t.alert({content:"修改成功",hideCancel:!0}).then(i)},function(e){t.alert({content:e})})}}function i(){e.go("tasksList")}var s=this;s.options={formState:{hideSiteId:!1}},s.fields=[],s.model={},s.submit=r,s.data={};var o=[],a=e.is("newTask");a?(s.model.ruleType=1,s.fields=[{key:"RuleGroupID",type:"select2",templateOptions:{label:"选择标签规则组",valueProp:"RuleGroupID",labelProp:"RuleGroupName",options:[],required:!0},controller:["$scope","rulesService",function(t,e){e.getRules({Status:4}).then(function(e){console.log(e),o=e&&e.Data||[],t.to.options=o,o.length&&(t.model.RuleGroupID=o[0].RuleGroupID)})}],watcher:{listener:function(t,e,n,r,i){if(e){var s=(o||[]).find(function(t){return t.RuleGroupID==e});if(s){var a=s.RuleGroupType;"网站"===a||"广告"===a?r.options.formState.hideSiteId=!1:r.options.formState.hideSiteId=!0}}}}},{key:"SiteID",type:"input2",hideExpression:"formState.hideSiteId",templateOptions:{label:"site ID/广告ID"},expressionProperties:{"templateOptions.required":"!formState.hideSiteId"}},{key:"time",type:"timeRange2",templateOptions:{label:"设置任务周期",required:!0}}]):n.getTasks({HYUniqueid:e.params.taskId}).then(function(t){if(console.log(t),t&&t.Data&&t.Data.length){var e=t.Data[0];s.data=e,s.model={TaskID:e.TaskID,time:{min:e.StartDate,max:e.EndDate}},s.fields=[{type:"static2",templateOptions:{label:"标签规则组",text:e.RuleGroupName}},{type:"static2",hideExpression:"!model.SiteID",templateOptions:{label:"site ID/广告ID",text:e.SiteID}},{key:"time",type:"timeRange2",templateOptions:{label:"设置任务周期",required:!0}}]}})}r.$inject=["$modalService","$state","tasksService","$modalService"],t.exports={template:n(66),controller:r}},function(t,e){t.exports='<form class="form-horizontal" ng-submit="$ctrl.submit()" name="$ctrl.form" novalidate style="max-width: 680px;">\r\n  <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n  </formly-form>\r\n  <div class="clearfix">\r\n    <button type="button" class="btn btn-default pull-right" ng-click="$ctrl.options.resetModel()">重置</button>  \r\n    <button type="submit" class="btn btn-primary submit-button pull-right">保存</button>\r\n  </div>\r\n</form>'},function(t,e,n){function r(t,e,n,r){var i=this;this.mode="year";var s=[{id:1,label:"Option 1"},{id:2,label:"Option 2"},{id:3,label:"Option 3"}];this.options={},this.fields=[],this.fields.push({type:"static2",templateOptions:{label:"static2",text:"text"}}),this.fields.push({key:"singleOption",type:"uiSelect2",templateOptions:{optionsAttr:"bs-options",label:"select",valueProp:"id",labelProp:"label",options:s,required:!0}}),this.fields.push({key:"text",type:"input2",templateOptions:{label:"input",minlength:10,maxlength:20,required:!0}}),this.fields.push({key:"time",type:"timeRange2",optionsTypes:["timeRange2"],templateOptions:{label:"设置任务周期",required:!0,mode:this.mode}}),this.itemArray=[{id:1,name:"first"},{id:2,name:"second"},{id:3,name:"third"},{id:4,name:"fourth"},{id:5,name:"fifth"}],this.selected={value:this.itemArray[0]},this.day=new Date,this.maxDate=new Date(2016,11,20),this.range={min:new Date(2016,10,3),max:new Date(2016,10,27)},n(function(){console.log("update"),i.day=new Date,i.range={min:new Date(2016,10,4),max:new Date(2016,10,28)},i.model.time={min:new Date(2016,10,4),max:new Date(2016,10,28)}},3e3),i.sTimeString="2016-10-20T19:17:05",i.sTime=r.fromString(i.sTimeString),i.sTimeString2=r.toString(i.sTime)}r.$inject=["$modalService","$datetimeModalService","$timeout","dateService"],t.exports={template:n(68),controller:r}},function(t,e){t.exports='<form class="form-horizontal" ng-submit="$ctrl.onSubmit()" name="$ctrl.form" novalidate>\r\n  <div class="clearfix">\r\n    <button type="button" class="btn btn-default pull-right" ng-click="$ctrl.options.resetModel()">清除规则</button>  \r\n    <button type="submit" class="btn btn-primary submit-button pull-right" ng-disabled="$ctrl.form.$invalid">保存</button>\r\n  </div>\r\n  \r\n  <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n  </formly-form>\r\n</form>\r\n<pre>{{$ctrl.model | json}}</pre>\r\n<!-- <pre>{{$ctrl.form | json}}</pre> -->\r\n\r\n\r\n<ui-select ng-model="$ctrl.selected.value">\r\n    <ui-select-match>\r\n        <span ng-bind="$select.selected.name"></span>\r\n    </ui-select-match>\r\n    <ui-select-choices repeat="item in ($ctrl.itemArray | filter: $select.search) track by item.id">\r\n        <span ng-bind="item.name"></span>\r\n    </ui-select-choices>\r\n</ui-select>\r\n\r\n\r\n\r\n<form action="" class="form-horizontal">\r\n  <datetime-picker ng-model="$ctrl.day" max-date="$ctrl.maxDate" mode="{{$ctrl.mode}}"></datetime-picker>\r\n  <p>{{ $ctrl.day }}</p>\r\n\r\n  <datetime-range ng-model="$ctrl.range" mode="{{$ctrl.mode}}"></datetime-range>\r\n  <p>{{ $ctrl.range }}</p>\r\n</form>\r\n<button class="btn btn-primary" ng-click="$ctrl.alert()">打开</button>\r\n\r\n<h1>原始日期字符串</h1>\r\n<h1>{{$ctrl.sTimeString}}</h1>\r\n<h1>date $filter格式化</h1>\r\n<h1>{{$ctrl.sTimeString | date:"yyyy-MM-dd hh:mm:ss"}}</h1>\r\n<h1>date2 $filter格式化</h1>\r\n<h1>{{$ctrl.sTimeString | date2}}</h1>\r\n<h1>dateString.fromString</h1>\r\n<h1>{{$ctrl.sTime | date:"yyyy-MM-dd hh:mm:ss"}}</h1>\r\n<h1>dateString.toString</h1>\r\n<h1>{{$ctrl.sTimeString2}}</h1>\r\n'},function(t,e){e.taskListState={parent:"app",name:"tasksList",url:"/task",title:"任务列表",component:"taskList"},e.newTaskState={parent:"app",name:"newTask",url:"/task/new",title:"新建任务列表",component:"editTask"},e.editTaskState={parent:"app",name:"editTask",url:"/task/:taskId/edit",title:"编辑任务列表",component:"editTask"},e.testState={parent:"app",name:"test",url:"/test",title:"测试",component:"test"}},function(t,e){function n(t,e,n){function r(t){return t=t||{},e.get(n+"/task/api/findtask",{params:t})}function i(t){var r={RuleGroupID:t.RuleGroupID,SiteID:t.SiteID,StartDate:t.StartDate,EndDate:t.EndDate};return e.post(n+"/task/api/task",r)}function s(t){var r={HYUniqueID:t.TaskID,StartDate:t.StartDate,EndDate:t.EndDate};return e.post(n+"/task/api/task?method=1",r)}return{getTasks:r,createTask:i,editTask:s}}n.$inject=["$q","$http","apiBaseUrl"],e.tasksService=n},function(t,e,n){var r=n(72),i=n(76),s=n(78),o=n(80),a=n(82),l=n(86),d=n(88),c=n(90),u=n(92),p=n(93),m=n(96);t.exports={components:{rulesList:o,viewRulesList:l,viewRules:a,newRules:s,newRuleList:i,newRule:r,importRules:d,importRulesModal:c},states:[u.rulesListState,u.newRulesState,u.newRuleListState,u.newRuleState,u.viewRulesListState,u.viewRulesState,u.importRuleState],factories:{rulesService:m.rulesService},runBlocks:[p.runFormlyConfig]}},function(t,e,n){function r(t){function e(){r.formList.push({options:{},model:{},fields:angular.copy(r.fields)})}function n(t){r.formList.splice(t,1)}var r=this;r.ruleTypes=t,r.fields=[],r.formList=[],r.addSection=e,r.removeSection=n,r.fields=[{key:"test",type:"input2",templateOptions:{label:"site ID/广告ID",required:!0}},{key:"test2",type:"bindTag",templateOptions:{required:!0}}],e(),r.formList[0].model={}}n(73),r.$inject=["ruleTypes"],t.exports={template:n(75),controller:r}},function(t,e){},,function(t,e){t.exports='<div>\r\n\t<div class="btn btn-default">提交规则组</div>\r\n</div>\r\n<div class="well" ng-repeat="form in $ctrl.formList track by $index">\r\n\t<button class="close" ng-click="$ctrl.removeSection($index)">&times;</button>\r\n\t<form class="form-horizontal" name="form.form" novalidate style="max-width: 680px;">\r\n\t\t<div class="text-right">\r\n      <button class="btn btn-default">保存</button>\r\n"\r\n      <button class="btn btn-default" ng-click="form.options.resetModel()">清除规则</button>\r\n    </div>\r\n    <formly-form model="form.model" fields="form.fields" form="form.form" options="form.options">\r\n    </formly-form>\r\n  </form>\t\r\n  <div>{{ form.model | json}}</div>\r\n</div>\r\n<div>\r\n\t<button class="btn btn-default" ng-click="$ctrl.addSection()">\r\n\t\t<span class="glyphicon glyphicon-plus-sign"></span>添加规则</button>\r\n</div>'},function(t,e,n){function r(t,e){function n(){e.getRule(i).then(function(n){n&&(r.ruleTypes=e.getRuleTypes(n.GroupType),t.is("newRuleList")&&r.ruleTypes.length&&t.go("newRule",{ruleType:r.ruleTypes[0].id}))})}var r=this;r.ruleTypes=[];var i=t.params.rulesId;n()}n(73),r.$inject=["$state","rulesService"],t.exports={template:n(77),controller:r}},function(t,e){t.exports='<div class="new-rule">\r\n\t<div class="app-main-nav">\r\n    <ul class="nav nav-pills nav-stacked">\r\n      <li ui-sref-active="active" ng-repeat="type in $ctrl.ruleTypes">\r\n      \t<a ui-sref="{ruleType: type.id}">{{ type.title }}</a>\r\n      </li>\r\n    </ul>\r\n\t</div>\r\n\t<div class="app-main-content">\r\n\t\t<ui-view class="app-ui-view"></ui-view>\r\n\t</div>\r\n</div>'},function(t,e,n){function r(t,e,n){var r=this;r.options={},r.model={rulesType:e[0].id},r.fields=[{key:"rulesType",type:"select2",templateOptions:{label:"选择规则组类型",valueProp:"id",labelProp:"title",options:e,required:!0}},{key:"asdf",type:"input2",templateOptions:{label:"site ID（选填）"}},{key:"ffff",type:"input2",templateOptions:{label:"规则组名称",required:!0}}],r.go=function(){t.go("newRuleList",{rulesId:"test"})}}r.$inject=["$state","rulesTypes","ruleTypes"],t.exports={template:n(79),controller:r}},function(t,e){t.exports='<div class="new-rules">\r\n  <form class="form-horizontal" ng-submit="$ctrl.onSubmit()" name="$ctrl.form" novalidate style="max-width: 680px;">\r\n    <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n    </formly-form>\r\n    <div class="row">\r\n      <div class="col-sm-8 col-sm-offset-4">\r\n        <button type="submit" class="btn btn-primary" ng-disabled="$ctrl.form.$invalid">下一步</button>\r\n        创建规则组，去设置标签规则\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <p><a ng-click="$ctrl.go()">测试用：创建规则</a></p>\r\n</div>\r\n'},function(t,e,n){function r(t,e){function n(e,n){t.getRules({Status:e}).then(function(t){r.data[n]=t&&t.Data||[]})}var r=this;r.store=e,r.data=[],r.rulesTitles=[{id:0,title:"加入任务-未开启"},{id:1,title:"加入任务-执行中"},{id:2,title:"加入任务-暂停中"},{id:3,title:"加入任务-已结束"},{id:4,title:"未加入任务"}],r.rulesTitles.forEach(function(t,e){n(t.id,e)})}r.$inject=["rulesService","store"],t.exports={template:n(81),controller:r}},function(t,e){t.exports='<div class="rules-list">\r\n  <div ng-repeat="rules in $ctrl.rulesTitles">\r\n    <div class="panel panel-default" ng-init="rules.isCollapsed=false">\r\n      <div class="panel-heading">\r\n        {{ rules.title }}\r\n        <button class="btn btn-link pull-right" ng-click="rules.isCollapsed = !rules.isCollapsed">\r\n          <span class="glyphicon" ng-class="{\'glyphicon-menu-down\': rules.isCollapsed, \'glyphicon-menu-up\': !rules.isCollapsed}"></span>\r\n        </button>\r\n      </div>\r\n      <div uib-collapse="rules.isCollapsed">\r\n        <div class="panel-body">\r\n          <table class="table table-bordered table-hover">\r\n            <thead class="bg-default">\r\n              <tr>\r\n                <td>site ID/广告ID</td>\r\n                <td>规则组名称</td>\r\n                <td>规则组类型</td>\r\n                <td>创建时间</td>\r\n                <td>加入任务时间</td>\r\n                <td ng-hide="$ctrl.store.hideEditArea">&nbsp;</td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr ng-repeat="row in $ctrl.data[$index]">\r\n                <td>{{ row.SiteID }}</td>\r\n                <td>{{ row.RuleGroupName }}</td>\r\n                <td>{{ row.RuleGroupType }}</td>\r\n                <td>{{ row.CreateTime | date2 }}</td>\r\n                <td>{{ row.CreateTaskTime | date2 }}</td>\r\n                <td ng-hide="$ctrl.store.hideEditArea">\r\n                  <a href="">复制规则组</a>\r\n                  <br>\r\n                  <a href="">导入规则组</a>\r\n                </td>\r\n              </tr>\r\n              <tr ng-if="!$ctrl.data[$index].length">\r\n                <td colspan="6" class="text-center">空</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>  \r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>'},function(t,e,n){function r(t,e,n){function r(){e.getRule(s).then(function(t){t&&(i.data=t,i.ruleTypes=e.getRuleTypes(t.GroupType),(t.Module||[]).forEach(function(t){var e=i.ruleTypes.find(function(e){return e.title==t.Name});console.log(t.Name),e&&(e.rules=(e.rules||[]).concat(t.Content))}))})}var i=this;i.data={},i.ruleTypes=[],i.store=n;var s=t.params.rulesId;console.log("enter view-rules"),r()}n(83),r.$inject=["$state","rulesService","store"],t.exports={template:n(85),controller:r}},function(t,e){},,function(t,e){t.exports='<div class="view-rules">\r\n  <div class="clearfix" ng-hide="$ctrl.store.hideEditArea">\r\n    <button class="btn btn-primary pull-right">导出规则组</button>\r\n  </div>\r\n  <dl class="dl-horizontal">\r\n    <dt>规则组类型：</dt>\r\n    <dd>{{ $ctrl.data.GroupType }}</dd>\r\n    <dt>site ID：</dt>\r\n    <dd>{{ $ctrl.data.SiteID }}</dd>\r\n    <dt>规则组名称：</dt>\r\n    <dd>{{ $ctrl.data.GroupName }}</dd>\r\n    <dt>规则组状态：</dt>\r\n    <dd>{{ $ctrl.data.GroupStatus }}</dd>\r\n    <dt>加入任务时间：</dt>\r\n    <dd>{{ $ctrl.data.JoinTaskTime | date2 }}</dd>\r\n    <dt>创建时间：</dt>\r\n    <dd>{{ $ctrl.data.CreateTime | date2 }}</dd>\r\n  </dl>  \r\n  <div ng-repeat="ruleType in $ctrl.ruleTypes">\r\n    <div class="panel panel-default" ng-init="ruleType.isCollapsed=false">\r\n      <div class="panel-heading">\r\n        {{ ruleType.title }}\r\n        <button class="btn btn-link pull-right" ng-click="ruleType.isCollapsed = !ruleType.isCollapsed">\r\n          <span class="glyphicon" ng-class="{\'glyphicon-menu-down\': ruleType.isCollapsed, \'glyphicon-menu-up\': !ruleType.isCollapsed}"></span>\r\n        </button>\r\n        <button class="btn btn-sm btn-primary pull-right" ng-hide="$ctrl.store.hideEditArea">添加规则</button>\r\n      </div>\r\n      <div uib-collapse="ruleType.isCollapsed">\r\n        <div class="panel-body">\r\n          <table class="table table-bordered table-hover">\r\n            <thead class="bg-default">\r\n              <tr>\r\n                <td>Key</td>\r\n                <td>Tag</td>\r\n                <td>权重</td>\r\n                <td>执行次数</td>\r\n                <td>\r\n                  状态\r\n                  <button class="btn btn-sm btn-primary" ng-hide="$ctrl.store.hideEditArea">保存</button>\r\n                </td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr ng-repeat="row in ruleType.rules">\r\n                <td>{{ row.Key }}</td>\r\n                <td ng-bind-html="row.Tag"></td>\r\n                <td>{{ row.Weight }}</td>\r\n                <td>{{ row.ExecCount }}</td>\r\n                <td>\r\n                  {{ row.Status }}\r\n                </td>\r\n              </tr>\r\n              <tr ng-if="!ruleType.rules.length">\r\n                <td colspan="5" class="text-center">空</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>  \r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'},function(t,e,n){function r(t,e){var n=this;e.getRules({Status:1}).then(function(e){n.data=e&&e.Data||[],t.is("viewRulesList")&&t.go("viewRules",{rulesId:n.data[0].RuleGroupID})})}r.$inject=["$state","rulesService"],t.exports={template:n(87),controller:r}},function(t,e){t.exports='<ul class="nav nav-tabs" style="margin-bottom:-1px;">\r\n  <li ng-repeat="row in $ctrl.data track by $index" ui-sref-active="active">\r\n    <a ui-sref="viewRules({ rulesId: row.RuleGroupID })">\r\n      <span ng-hide="!row.SiteID">\r\n        {{ row.SiteID }}-\r\n      </span>\r\n      {{ row.RuleGroupName }}\r\n    </a>\r\n  </li>\r\n</ul>\r\n<div class="panel panel-default">\r\n  <div class="panel-body">\r\n    <ui-view></ui-view>\r\n  </div>\r\n</div>'},function(t,e,n){function r(t,e){function n(t){i.errMsg="",i.succMsg="",i.uploading=!0,e.importFile(t).then(function(t){i.uploading=!1,i.succMsg=t.Information},function(t){i.uploading=!1,i.errMsg=t})}function r(){var e=t.open({size:"400",component:"importRulesModal"});e.result.then(function(t){console.log("xxxxxxxxxxxxxx"),console.log(t)})}var i=this;i.selectFile=n,i.showImportModal=r,i.errMsg="",i.succMsg="",i.uploading=!1}r.$inject=["$uibModal","rulesService"],t.exports={template:n(89),controller:r}},function(t,e){t.exports='<div style="min-height: 200px;">\r\n  <!-- 打开弹窗选择文件 -->\r\n  <p class="hide">\r\n    <button class="btn btn-primary" ng-click="$ctrl.showImportModal()">\r\n      导入规则组\r\n    </button>\r\n  </p>\r\n  <!-- 直接选择文件 -->\r\n  <p>\r\n    <input-file class="btn btn-primary" on-change="$ctrl.selectFile(file)"> \r\n      选择文件\r\n    </input-file>\r\n  </p>\r\n  <p class="text-warn hide">\r\n    数据上传中47%\r\n  </p>\r\n  <p ng-show="$ctrl.succMsg">\r\n    导入成功：{{ $ctrl.succMsg }}\r\n    <a>查看规则组详情&gt;&gt;</a>\r\n  </p>\r\n  <p ng-show="$ctrl.errMsg">\r\n    导入失败：{{ $ctrl.errMsg }}\r\n  </p>\r\n</div>\r\n<div class="hide">\r\n  <h5>导入规则组历史</h5>\r\n  <div class="hr"></div>\r\n  <div style="text-align:center;line-height:200px;">暂无导入规则组历史</div>\r\n  <table class="table table-bordered table-hover">\r\n    <thead class="bg-default">\r\n      <tr>\r\n        <th>导入时间</th>\r\n        <th>导入结果</th>\r\n        <th>规则组名称</th>\r\n        <th>规则模块</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td>2016-10-27  10:55:23</td>\r\n        <td>导入失败</td>\r\n        <td>Arla官网打标签规则</td>\r\n        <td>点击</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>'},function(t,e,n){function r(t){var e=this,n=[{id:1,label:"Option 1"},{id:2,label:"Option 2"},{id:3,label:"Option 3"}],r=[{id:1,label:"页面"},{id:2,label:"点击"},{id:3,label:"订单"},{id:4,label:"购物车"},{id:5,label:"会员"},{id:6,label:"微信"},{id:7,label:"会员积分"},{id:8,label:"搜索"},{id:9,label:"活动"},{id:10,label:"优惠卷"},{id:11,label:"中奖"},{id:12,label:"答题"}];e.model={selectRules:n[0].id,selectModule:r[0].id},e.options={},e.fields=[{key:"selectRules",type:"select2",templateOptions:{label:"选择标签规则组",valueProp:"id",labelProp:"label",options:n,required:!0}},{key:"selectModule",type:"select2",templateOptions:{label:"选择网站模块",valueProp:"id",labelProp:"label",options:r,required:!0}}],e.selectFile=function(t){e.close({$value:t})}}r.$inject=["$scope"],t.exports={template:n(91),controller:r,bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(t,e){t.exports='<div class="modal-body">\r\n  <form class="form-horizontal" name="$ctrl.form" novalidate>\r\n    <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n  </formly-form>\r\n  </form>\r\n</div>\r\n<div class="modal-footer">\r\n  <input-file class="btn btn-primary" on-change="$ctrl.selectFile(file)">选择文件</input-file>\r\n  <button class="btn btn-default" type="button" ng-click="$ctrl.dismiss();">取消</button>\r\n</div>'},function(t,e){e.rulesListState={parent:"app",name:"rulesList",url:"/rules",title:"规则组列表",component:"rulesList"},e.newRulesState={parent:"app",name:"newRules",url:"/rules/new",title:"新建规则组",component:"newRules"},e.viewRulesListState={parent:"app",name:"viewRulesList",url:"/rules/view",title:"规则组详情",component:"viewRulesList"},e.viewRulesState={parent:"viewRulesList",name:"viewRules",url:"/:rulesId",title:"规则组详情",component:"viewRules"},e.newRuleListState={parent:"app",name:"newRuleList",url:"/rules/:rulesId/rule",title:"新建规则组",component:"newRuleList"},e.newRuleState={parent:"newRuleList",name:"newRule",url:"/:ruleType",title:"新建规则组",component:"newRule"},e.importRuleState={parent:"app",name:"importRules",url:"/rule/import",title:"导入规则组",component:"importRules"}},function(t,e,n){e.runFormlyConfig=["formlyConfig","formlyValidationMessages",function(t,e){t.setType(n(94))}]},function(t,e,n){t.exports={name:"bindTag",template:n(95),defaultOptions:{noFormControl:!0,wrapper:["bootstrapLabel","bootstrapHasError"]},controller:["$scope","$timeout",function(t,e){function n(t){return{key:a+"["+t+"].weight",type:"input",className:"no-label",templateOptions:{required:!0}}}function r(t,n){return e(function(){s=n.templateOptions.options=[{id:1,title:"aaa"},{id:2,title:"bbb"},{id:3,title:"ccc"},{id:4,title:"ddd"},{id:5,title:"eee"},{id:6,title:"fff"}]},1e3)}function i(t){o[a]=o[a]||[],o[a].push({weight:"",tagId:t.id,tagTitle:t.title})}t.copyItemOptions=n,t.selectTag=i,t.hideModel={},t.hideFields=[{key:"search",type:"uiSelectAsync2",templateOptions:{optionsAttr:"bs-options",label:"关联标签",options:[],valueProp:"id",labelProp:"title",refresh:r,refreshDelay:100}}];var s,o=t.model,a=t.options.key;t.$watch("hideModel.search",function(t){s&&s.forEach(function(e,n){e.id===t&&i(e)})})}]}},function(t,e){t.exports='<div class="col-xs-12">\r\n  <formly-form fields="hideFields" model="hideModel">\r\n  </formly-form>\r\n  <div ng-show="model[options.key].length">\r\n    <div class="clearfix text-center" style="margin-bottom:15px">\r\n      <div class="col-xs-4">权重</div>\r\n      <div class="col-xs-8">已选标签</div>\r\n    </div>\r\n    <div class="clearfix"\r\n         ng-repeat="item in model[options.key] track by $index"\r\n         ng-init="itemOptions = copyItemOptions($index)">\r\n      <div class="col-xs-4">\r\n        <formly-field class="no-padding"\r\n                      options="itemOptions"\r\n                      model="model"\r\n                      form="form">\r\n        </formly-field>\r\n      </div>\r\n      <div class="col-xs-8" style="line-height: 32px;">\r\n        <div>\r\n          {{ model[options.key][$index].tagTitle }}\r\n          <a ng-click="model[options.key].splice($index, 1)">\r\n            <span class="glyphicon glyphicon-trash"></span>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </div>  \r\n  </div>\r\n</div>'},function(t,e){function n(t,e,n,r){function i(t){return t=t||{},e.get(n+"/task/api/findrulegroup",{params:t})}function s(t){return e.get(n+"/task/api/TaskDetail/"+t)}function o(t){var e=r.find(function(e){return e.title===t});return e?angular.copy(e.types):[]}function a(t){var r={pic:t};return e.post(n+"/rule/api/RuleImport",r,{headers:{"Content-Type":void 0},transformRequest:function(t,e){var n=new FormData;return angular.forEach(t,function(t,e){n.append(e,t)}),n}})}return{getRules:i,getRule:s,getRuleTypes:o,importFile:a}}n.$inject=["$q","$http","apiBaseUrl","rulesTypes"],e.rulesService=n}]);
//# sourceMappingURL=app.js.map