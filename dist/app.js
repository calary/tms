!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r=n(1),i=n(2),s=n(31),a=n(59),o=n(69),l=n(80),d={states:[],constants:{},components:{},directives:{},services:{},factories:{},filters:{},configBlocks:[],runBlocks:[]},c=[i,s,a,o,l].map(function(e){return Object.assign({},d,e)});c.forEach(function(e){r.config(["$stateProvider",function(t){return e.states.forEach(function(e){return t.state(e)})}]),Object.keys(e.constants).forEach(function(t){return r.constant(t,e.constants[t])}),Object.keys(e.components).forEach(function(t){return r.component(t,e.components[t])}),Object.keys(e.directives).forEach(function(t){return r.directive(t,e.directives[t])}),Object.keys(e.services).forEach(function(t){return r.service(t,e.services[t])}),Object.keys(e.factories).forEach(function(t){return r.factory(t,e.factories[t])}),Object.keys(e.filters).forEach(function(t){return r.filter(t,e.filters[t])}),e.configBlocks.forEach(function(e){return r.config(e)}),e.runBlocks.forEach(function(e){return r.run(e)})})},function(e,t){e.exports=angular.module("app",["ngAnimate","ngMessages","ngSanitize","ui.bootstrap","ui.select","ui.router","uiSwitch","formly","formlyBootstrap"])},function(e,t,n){var r=n(3);e.exports={runBlocks:[r.runFormlyConfig]}},function(e,t,n){n(4),t.runFormlyConfig=["formlyConfig","formlyValidationMessages",function(e,t){e.setWrapper(n(8)),e.setWrapper(n(10)),e.setWrapper(n(12)),e.setType(n(14)),e.setType(n(15)),e.setType(n(16)),e.setType(n(17)),e.setType(n(18)),e.setType(n(19)),e.setType(n(20)),e.setType(n(21)),e.setType(n(22)),e.setType(n(23)),e.setType(n(25)),e.setType(n(27)),e.setType(n(28)),e.setType(n(30)),e.extras.errorExistsAndShouldBeVisibleExpression="fc.$touched || form.$submitted",e.extras.ngModelAttrsManipulatorPreferBound=!0,t.addStringMessage("required","必填"),t.addStringMessage("maxlength","输入太长了"),t.messages.pattern=function(e,t,n){return e+" is invalid"},t.addTemplateOptionValueMessage("minlength","minlength","","is the minimum length","Too short")}]},function(e,t){},,,,function(e,t,n){e.exports={name:"validation",template:n(9)}},function(e,t){e.exports='<formly-transclude></formly-transclude>\r\n<div class="validation"\r\n  ng-if="fc.$touched || form.$submitted"\r\n  ng-messages="fc.$error">\r\n  <div ng-message="{{::name}}" ng-repeat="(name, message) in ::options.validation.messages">\r\n    <span class="glyphicon glyphicon-exclamation-sign"></span>\r\n    {{message(fc.$viewValue, fc.$modelValue, this)}}\r\n  </div>\r\n</div>'},function(e,t,n){e.exports={name:"horizontalBootstrapWrapper",template:n(11)}},function(e,t){e.exports="<div ng-class=\"to.labelClass ? to.labelClass : 'col-sm-4'\"></div>\r\n<div ng-class=\"to.valueClass ? to.valueClass : 'col-sm-8'\">\r\n  <formly-transclude></formly-transclude>\r\n</div>"},function(e,t,n){e.exports={name:"horizontalBootstrapLabel",template:n(13)}},function(e,t){e.exports="<label for=\"{{::id}}\" ng-class=\"['control-label', to.labelClass ? to.labelClass : 'col-sm-4']\">\r\n  {{to.label}}\r\n</label>\r\n<div ng-class=\"to.valueClass ? to.valueClass : 'col-sm-8'\">\r\n  <formly-transclude></formly-transclude>\r\n</div>"},function(e,t){e.exports={name:"checkbox2",extends:"checkbox",wrapper:["validation","horizontalBootstrapWrapper","bootstrapHasError"]}},function(e,t){e.exports={name:"input2",extends:"input",wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"]}},function(e,t){e.exports={name:"plainTimeRange",template:'<datetime-range ng-model="model[options.key]"></datetime-range>',defaultOptions:{ngModelAttrs:{mode:{bound:"mode",attribute:"mode"}}}}},function(e,t){e.exports={name:"time",template:'<datetime-picker ng-model="model[options.key]"></datetime-picker>',wrapper:["bootstrapLabel","bootstrapHasError"],defaultOptions:{ngModelAttrs:{mode:{bound:"mode",attribute:"mode"},minDate:{bound:"min-date",attribute:"min-date"},maxDate:{bound:"max-date",attribute:"max-date"}}}}},function(e,t){e.exports={name:"time2",extends:"time",wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"]}},function(e,t){e.exports={name:"timeRange",extends:"plainTimeRange",wrapper:["validation","bootstrapLabel","bootstrapHasError"]}},function(e,t){e.exports={name:"timeRange2",extends:"plainTimeRange",wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"]}},function(e,t){e.exports={name:"select2",extends:"select",wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"]}},function(e,t){e.exports={name:"static2",template:'<p class="form-control-static">{{to.text}}</p>',wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"],defaultOptions:{noFormControl:!0}}},function(e,t,n){var r=1;e.exports={name:"repeatSection",template:n(24),controller:function(e){function t(e){return e=angular.copy(e),i(e),e}function n(){e.model[e.options.key]=e.model[e.options.key]||[];var t=e.model[e.options.key],n=t[t.length-1],r={};n&&(r=angular.copy(n)),t.push(r)}function i(e){r++,angular.forEach(e,function(e,t){return e.fieldGroup?void i(e.fieldGroup):(e.templateOptions&&e.templateOptions.fields&&i(e.templateOptions.fields),void(e.id=e.id||e.key+"_"+t+"_"+r+s(0,9999)))})}function s(e,t){return Math.floor(Math.random()*(t-e))+e}e.formOptions={formState:e.formState},e.addNew=n,e.copyFields=t}}},function(e,t){e.exports='<div>\r\n  <!--loop through each element in model array-->\r\n  <div class="row">\r\n    <div class="repeatsection" ng-repeat="element in model[options.key]" ng-init="fields = copyFields(to.fields)">\r\n      <formly-form fields="fields"\r\n                   model="element"\r\n                   form="form">\r\n      </formly-form>\r\n      <div style="margin-bottom:20px;">\r\n        <button type="button" class="btn btn-sm btn-danger" ng-click="model[options.key].splice($index, 1)">\r\n          Remove\r\n        </button>\r\n      </div>\r\n      <hr>\r\n  </div>\r\n  <p class="AddNewButton">\r\n    <button type="button" class="btn btn-primary" ng-click="addNew()" >{{to.btnText}}</button>\r\n  </p>\r\n</div>'},function(e,t,n){e.exports={name:"uiSelect",wrapper:["validation","bootstrapLabel","bootstrapHasError"],template:n(26)}},function(e,t){e.exports='<ui-select ng-model="model[options.key]" required="{{to.required}}" disabled="{{to.disabled}}" search-enabled="false" theme="bootstrap">\r\n  <ui-select-match placeholder="{{to.placeholder}}" allow-clear="true">{{$select.selected[to.labelProp || \'name\']}}</ui-select-match>\r\n  <ui-select-choices group-by="to.groupBy" repeat="option[to.valueProp || \'value\'] as option in to.options">\r\n    <div ng-bind-html="option[to.labelProp] | highlight: $select.search"></div>\r\n  </ui-select-choices>\r\n</ui-select>'},function(e,t,n){e.exports={name:"uiSelect2",wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"],template:n(26)}},function(e,t,n){e.exports={name:"uiSelectAsync",wrapper:["validation","bootstrapLabel","bootstrapHasError"],template:n(29)}},function(e,t){e.exports='<ui-select ng-model="model[options.key]" required="{{to.required}}" disabled="{{to.disabled}}" theme="bootstrap" spinner-enabled="true">\r\n  <ui-select-match placeholder="{{to.placeholder}}">{{$select.selected[to.labelProp || \'name\']}}</ui-select-match>\r\n  <ui-select-choices repeat="option[to.valueProp || \'value\'] as option in to.options" refresh="to.refresh($select.search, options)" refresh-delay="{{to.refreshDelay}}">\r\n    <div ng-bind-html="option[to.labelProp] | highlight: $select.search"></div>\r\n  </ui-select-choices>\r\n  <ui-select-no-choices>无匹配结果</ui-select-no-choices>\r\n</ui-select>'},function(e,t,n){e.exports={name:"uiSelectAsync2",wrapper:["validation","horizontalBootstrapLabel","bootstrapHasError"],template:n(29)}},function(e,t,n){var r=n(32),i=n(34),s=n(38),a=n(39),o=n(40),l=n(41),d=n(42),c=n(45),u=n(46),p=n(47),m=n(51),f=n(55),g=n(57);e.exports={components:{baseModal:r,datetimeModal:i},directives:{inputFile:d,datetimePicker:m,datetimeRange:f,xxClick:c,xxBindHtml:u,xxTable:p},factories:{$modalService:s,$datetimeModalService:a,dateService:o},filters:{date2:l},runBlocks:[g.cacheTemplateRunBlock,g.runFormlyConfig]}},function(e,t,n){function r(e){function t(){if(r.handleOk){if(r.lock)return;r.lock=!0,r.handleOk().then(function(){r.close()}).finally(function(){r.lock=!1})}else r.close()}function n(){r.dismiss()}var r=this,i=r.resolve.config;console.log(i),r.title=i.title||"",r.content=i.content||"",r.okLabel=i.okLabel||"确定",r.cancelLabel=i.cancelLabel||"取消",r.hideOk=i.hideOk||!1,r.hideCancel=i.hideCancel||!1,r.handleOk=i.handleOk||null,r.isToast=i.isToast||null,r.timeout=i.timeout||3e3,r.ok=t,r.cancel=n,r.lock=!1,r.isToast&&e(n,vm.timeout)}r.$inject=["$timeout"],e.exports={template:n(33),controller:r,bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(e,t){e.exports='<div class="modal-header bg-primary" ng-show="$ctrl.title" >\r\n\t<button type="button" class="close" ng-click="$ctrl.cancel();"><span>&times;</span></button>\r\n    <h4 class="modal-title" ng-bind-html="$ctrl.title"></h4>\r\n</div>\r\n<div class="modal-body" ng-class="{\'modal-toast\': $ctrl.isToast}">\r\n    <div ng-bind-html="$ctrl.content"></div>\r\n</div>\r\n<div class="modal-footer" ng-hide="$ctrl.isToast">\r\n    <button class="btn btn-success" type="button" ng-disabled="$ctrl.lock" ng-hide="$ctrl.hideOk" ng-click="$ctrl.ok();">{{ $ctrl.okLabel }}</button>\r\n    <button class="btn btn-default" type="button" ng-hide="$ctrl.hideCancel" ng-click="$ctrl.cancel();">{{ $ctrl.cancelLabel }}</button>\r\n</div>'},function(e,t,n){function r(e){function t(){r.close({$value:r.date})}function n(){r.dismiss()}var r=this;r.ok=t,r.cancel=n;var i=r.resolve.config,s=i.date?angular.copy(i.date):new Date,a=i.minDate?angular.copy(i.minDate):null,o=i.maxDate?angular.copy(i.maxDate):null,l=i.mode?i.mode.toLowerCase():"datetime",d="time"===l||"datetime"===l?"day":l;r.showDate="time"!==l,r.showTime="datetime"===l||"time"===l,r.date=s,r.options={showWeeks:!1,minDate:a,maxDate:o,minMode:d},e.$watch("$ctrl.date",function(e){a&&a.getTime()>=r.date.getTime()&&r.date.setTime(a.getTime()+1e3),o&&o.getTime()<=r.date.getTime()&&r.date.setTime(o.getTime()-1e3)})}n(35),r.$inject=["$scope"],e.exports={template:n(37),controller:r,bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(e,t){},,function(e,t){e.exports='<div class="modal-header bg-default">\r\n\t<button type="button" class="close" ng-click="$ctrl.dismiss();"><span>&times;</span></button>\r\n    <h4 class="modal-title">选择时间</h4>\r\n</div>\r\n<div class="modal-body">\r\n  <div uib-datepicker \r\n    ng-model="$ctrl.date" \r\n    ng-show="$ctrl.showDate"\r\n    datepicker-options="$ctrl.options"></div>\r\n  <div uib-timepicker \r\n    ng-model="$ctrl.date"\r\n    ng-show="$ctrl.showTime"\r\n    readonly-input="true"\r\n    show-meridian="false"\r\n    template-url="global/datetime-modal.timepicker.html"\r\n    show-seconds="true"></div>\r\n<!--   <div>当前时间{{ $ctrl.date | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最小日期{{ $ctrl.options.minDate | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最大日期{{ $ctrl.options.maxDate | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最小时间{{ $ctrl.minTime | date:\'yyyy-MM-dd HH:mm:ss\' }}</div>\r\n  <div>最大时间{{ $ctrl.maxTime | date:\'yyyy-MM-dd HH:mm:ss\' }}</div> -->\r\n</div>\r\n<div class="modal-footer">\r\n  <button class="btn btn-success" type="button" ng-click="$ctrl.ok();">确定</button>\r\n  <button class="btn btn-default" type="button" ng-click="$ctrl.dismiss();">取消</button>\r\n</div>'},function(e,t){e.exports=["$uibModal",function(e){function t(t){var n=e.open({size:"sm",component:"baseModal",resolve:{config:function(){return t}}});return n.result}function n(e){return e=e||{},e.hideCancel=!0,t(e)}function r(e){return e=e||{},e.isToast=!0,t(e)}return{confirm:t,alert:n,toast:r}}]},function(e,t){e.exports=["$uibModal",function(e){function t(t){var n=e.open({size:"sm",component:"datetimeModal",windowClass:"datetime-modal",resolve:{config:t||{}}});return n.result}return{show:t}}]},function(e,t){e.exports=["$filter",function(e){function t(){var e=new Date;return 60*e.getTimezoneOffset()*1e3}function n(e){return s.test(e)}function r(e){if(n(e))return e=e.replace("T"," "),new Date(e)}function i(t){return e("date")(t,"yyyy-MM-dd HH:mm:ss")}var s=/^(\d{4})-(\d\d)-(\d\d)(T|\s)(\d\d):(\d\d):(\d\d)/;t();return{isDateString:n,fromString:r,toString:i}}]},function(e,t){e.exports=["$filter","dateService",function(e,t){return function(t){return e("date")(t,"yyyy-MM-dd HH:mm:ss")}}]},function(e,t,n){function r(e){var t=document.createElement("form"),n=document.createElement("div"),r=e.parentNode;r.replaceChild(n,e),t.appendChild(e),t.reset(),r.replaceChild(e,n)}function i(){return console.log("wa"),{retrict:"AE",scope:{disabled:"=",accept:"@",onChange:"&"},transclude:!0,template:["<span ng-transclude></span>",'<input type="file">'].join(""),link:function(e,t,n){function i(t){var n=t.target.files;n.length>0&&(e.onChange({file:n[0]}),r(t.target))}var s=t.find("input");s.bind("change",i),s.attr("accept",e.accept||"*")}}}n(43),i.$inject=[],e.exports=i},function(e,t){},,function(e,t){function n(e,t){return{retrict:"A",link:function(e,n,r){function i(){if(!s){var i=e.$apply(r.xxClick),a=!(!i||!i.then);a&&(n.attr("disabled",!0),s=!0,t.when(i).finally(function(){s=!1,n.attr("disabled",!1)}))}}var s=!1;n.on("click",i)}}}n.$inject=["$timeout","$q"],e.exports=n},function(e,t){function n(e){return{retrict:"A",link:function(t,n,r){t.$watch(function(){return t.$eval(r.xxBindHtml)},function(r){n.html(r),e(n.contents())(t)})}}}n.$inject=["$compile"],e.exports=n},function(e,t,n){function r(e,t){return{retrict:"AE",scope:{config:"=",onInit:"&"},template:n(50),link:function(n,r,i){function s(){var e=n.config||{};n.data=e.data||[],n.columns=e.columns||[],n.methods=e.methods||{},n.update=a,n.onInit({update:a}),"data"in e&&(n.status=3),e.firstUpdate&&a()}function a(){console.log("update called");var e=n.config.getData;if(e){var r=e&&e(),i=++l;angular.isArray(r)?(n.status=3,n.data=r):(n.status=1,t.all([r,o()]).then(function(e){console.log("res then succ",i,l),i===l&&(n.status=3,n.data=e[0])},function(e){console.log(e,i,l),i===l&&(e&&e.status===-1?n.error="您已离线":n.error="错误"+e,n.status=2)}))}}function o(){return e(function(){console.log("at least 300ms")},300)}n.status=0,n.error="",n.data=[],n.update,n.columns=[],n.methods={};var l=0;s()}}}n(48),r.$inject=["$timeout","$q"],e.exports=r},function(e,t){},,function(e,t){e.exports='<div class="xx-table">\r\n  <table class="table table-bordered table-hover">\r\n    <thead class="bg-default">\r\n      <tr>\r\n        <td \r\n          ng-repeat="column in columns"\r\n          xx-bind-html="column.head"\r\n          ng-hide="column.hide"\r\n        ></td>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr class="xx-table-tip" ng-show="status!==3||data.length==0">\r\n        <td ng-show="status==1" colspan="{{columns.length}}" class="text-center">请求中…</td>\r\n        <td ng-show="status==2"  colspan="{{columns.length}}" class="text-center">\r\n          请求失败，{{ error }}\r\n          <button class="btn btn-link btn-sm" ng-click="update()">\r\n            <span class="glyphicon glyphicon-repeat"></span>\r\n            重新请求\r\n          </button>\r\n        </td>\r\n        <td ng-show="status==3&&data.length==0" colspan="{{columns.length}}" class="text-center">空</td>\r\n      </tr>\r\n      <tr ng-repeat="row in data track by $index">\r\n        <td \r\n          ng-repeat="column in columns"\r\n          xx-bind-html="column.data"\r\n          ng-hide="column.hide"\r\n        ></td>\r\n      </tr>\r\n    </tbody>\r\n  </table> \r\n</div>\r\n'},function(e,t,n){function r(e){return{retrict:"AE",scope:{minDate:"=",maxDate:"=",mode:"@"},require:"ngModel",template:n(54),link:function(t,n,r,i){function s(e){if(e&&!(e instanceof Date))try{e=new Date(e)}catch(e){}return e}var a,o=t.mode;switch(o){case"year":a="yyyy年";break;case"month":a="yyyy-MM";break;case"day":a="yyyy-MM-dd";break;case"time":a="HH:mm:ss";break;default:a="yyyy-MM-dd HH:mm:ss"}t.format=a,t.selectTime=function(){e.show({date:s(t.date),minDate:s(t.minDate),maxDate:s(t.maxDate),mode:t.mode}).then(function(e){i.$setViewValue(e),i.$render()})},i.$render=function(){t.date=i.$viewValue};var l=!1;r.$observe("required",function(e){l=e===!0||"true"===e,i.$validate()}),i.$validators.required=function(e){return!l||!!e}}}}n(52),r.$inject=["$datetimeModalService"],e.exports=r},function(e,t){},,function(e,t){e.exports='<div class="input-group">\r\n    <p class="form-control">{{ date | date:format }}</p>\r\n    <span class="input-group-btn">\r\n      <button class="btn btn-default" type="button" ng-click="selectTime()">\r\n        <span class="glyphicon glyphicon-calendar"></span>\r\n      </button>\r\n    </span>\r\n  </div>\r\n</div>'},function(e,t,n){function r(e){return{retrict:"AE",require:"ngModel",scope:{mode:"@"},template:n(56),link:function(e,t,n,r){e.$watch("minDate+maxDate",function(){var t=e.minDate,n=e.maxDate;t&&t instanceof String&&(e.minDate=new Date(t)),n&&n instanceof String&&(e.maxDate=new Date(n)),r.$setViewValue({min:e.minDate,max:e.maxDate})}),r.$render=function(){var t=r.$isEmpty(r.$viewValue)?{}:r.$viewValue;e.minDate=t.min,e.maxDate=t.max};var i=!1;n.$observe("required",function(e){i=e===!0||"true"===e,r.$validate()}),r.$validators.required=function(e){return!i||!!(e&&e.min&&e.max)}}}}n(52),r.$inject=["$datetimeModalService"],e.exports=r},function(e,t){e.exports='<div class="datetime-range">\r\n  <datetime-picker \r\n    class="datetime-range-start"\r\n    ng-model="minDate"\r\n    max-date="maxDate"\r\n    mode="{{mode}}"\r\n  ></datetime-picker>\r\n  <div class="datetime-range-divider" style="line-height: 34px;"> 至 </div>\r\n  <datetime-picker \r\n    class="datetime-range-end"\r\n    ng-model="maxDate"\r\n    min-date="minDate"\r\n    mode="{{mode}}"\r\n  ></datetime-picker>\r\n</div>\r\n'},function(e,t,n){t.cacheTemplateRunBlock=["$templateCache",function(e){e.put("global/datetime-modal.timepicker.html",n(58))}]},function(e,t){e.exports='<table class="uib-timepicker">\r\n  <tbody>\r\n    <tr>\r\n      <td rowspan="2" class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\r\n        <input type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\r\n      </td>\r\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn" ng-disabled="noIncrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td rowspan="2" class="uib-time-name">时</td>\r\n      <td rowspan="2" class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\r\n        <input type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\r\n      </td>\r\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn" ng-disabled="noIncrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td rowspan="2" class="uib-time-name">分</td>\r\n      <td rowspan="2" class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\r\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td rowspan="2" ng-show="showSeconds" class="uib-time-name">秒</td>\r\n      <td rowspan="2" ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\r\n    </tr>\r\n    <tr>\r\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n    </tr>\r\n    <!-- <tr class="text-center" ng-show="::showSpinners">\r\n      \r\n      \r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr>\r\n    <tr>\r\n    \r\n\r\n      <td ng-show="showSeconds" class="uib-separator">:</td>\r\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\r\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\r\n    </tr>\r\n    <tr class="text-center" ng-show="::showSpinners">\r\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td>&nbsp;</td>\r\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr> -->\r\n  </tbody>\r\n</table>\r\n\r\n<!-- \r\n\r\n<table class="uib-timepicker">\r\n  <tbody>\r\n    <tr class="text-center" ng-show="::showSpinners">\r\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn btn-link" ng-disabled="noIncrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td>&nbsp;</td>\r\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn btn-link" ng-disabled="noIncrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr>\r\n    <tr>\r\n      <td class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\r\n        <input type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\r\n      </td>\r\n      <td class="uib-separator">:</td>\r\n      <td class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\r\n        <input type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showSeconds" class="uib-separator">:</td>\r\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\r\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\r\n      </td>\r\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\r\n    </tr>\r\n    <tr class="text-center" ng-show="::showSpinners">\r\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td>&nbsp;</td>\r\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showSeconds">&nbsp;</td>\r\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\r\n      <td ng-show="showMeridian"></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n -->'},function(e,t,n){var r=n(60),i=n(62),s=n(63),a=n(64),o=n(65),l=n(66);n(67),e.exports={constants:{store:i.store,apiBaseUrl:i.apiBaseUrl,rulesTypes:i.rulesTypes,ruleTypes:i.ruleTypes,taskStatus:i.taskStatus,boolOptions:i.boolOptions,timeOptions:i.timeOptions,compareOptions:i.compareOptions,sexOptions:i.sexOptions,pointsOptions:i.pointsOptions,couponOptions:i.couponOptions},factories:{fieldOptionsService:l},components:{app:r},filters:{taskStatusFilter:o.taskStatusFilter},states:[s.appState],configBlocks:[a.otherwiseConfigBlock,a.httpConfigBlock],runBlocks:[]}},function(e,t,n){function r(e,t,n,r){function i(){var e=t.is("newRules")||t.is("newRuleList")||t.is("newRule");a.isNewRules=e}function s(){a.isRulesList=t.is("rulesList")||t.is("viewRules")&&2==o,a.isViewRulesList=t.is("viewRulesList")||t.is("viewRules")&&1==o}var a=this;a.$state=t,a.store=r,a.isRulesList=!1,a.isViewRulesList=!1,a.isNewRules=!1;var o=0;n.onSuccess({},function(){i(),s()}),e.$on("VIEW_RULES_TYPE",function(e,t){o=t,s()}),i(),s()}r.$inject=["$rootScope","$state","$transitions","store"],e.exports={template:n(61),controller:r}},function(e,t){e.exports='<div class="app-main">\r\n  <div class="app-main-nav">\r\n    <h1 class="page-title">任务管理</h1>\r\n<!--     <p>\r\n      <label>\r\n        <input type="checkbox" ng-model="$ctrl.store.hideEditArea">隐藏\r\n      </label>\r\n    </p> -->\r\n    <ul class="nav nav-pills nav-stacked">\r\n      <li ui-sref-active="active"><a ui-sref="tasksList">任务列表</a></li>\r\n      <li ui-sref-active="active"><a ui-sref="newTask">新建任务</a></li>\r\n      <li ng-class="{\'active\': $ctrl.isRulesList}"><a ui-sref="rulesList">规则组列表</a></li>\r\n      <li ng-class="{\'active\': $ctrl.isViewRulesList}"><a ui-sref="viewRulesList">执行期规则组</a></li>\r\n      <li ng-class="{\'active\': $ctrl.isNewRules}" ng-hide="$ctrl.store.hideEditArea"><a ui-sref="newRules">新建规则组</a></li>\r\n      <li ui-sref-active="active"><a ui-sref="importRules">导入规则组</a></li>\r\n      <li ui-sref-active="active" ng-hide="$ctrl.store.hideEditArea"><a ui-sref="test">测试</a></li>\r\n    </ul>\r\n  </div>\r\n  <div class="app-main-content">\r\n    <h1 class="page-title">{{$ctrl.$state.$current.title}}</h1>\r\n    <ui-view class="app-ui-view"></ui-view>\r\n  </div>\r\n</div>'},function(e,t){t.store={hideEditArea:!0,viewRulesNav:!1},t.apiBaseUrl="http://dmp.arlakitchen.com",t.rulesTypes=[{id:"网站",title:"网站",types:[{id:101,title:"页面"},{id:102,title:"点击"},{id:103,title:"订单"},{id:104,title:"购物车"},{id:105,title:"微信"},{id:106,title:"会员积分"},{id:107,title:"搜索"},{id:108,title:"活动"},{id:109,title:"优惠券"},{id:110,title:"中奖"},{id:111,title:"关联型"}]},{id:"广告",title:"广告",types:[{id:201,title:"广告主题/特征"},{id:202,title:"广告曝光量"},{id:203,title:"广告点击量"},{id:204,title:"广告投放媒体"}]},{id:"呼叫中心",title:"呼叫中心",types:[{id:301,title:"电话归属地"},{id:302,title:"呼入手机号"},{id:303,title:"呼入手机号运营商"},{id:304,title:"呼入时段"},{id:305,title:"呼叫内容关键字"}]},{id:"社会化媒体",title:"社会化媒体",types:[]}],t.ruleTypes=[{id:1,title:"网站",types:[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}]},{id:2,title:"网站",types:[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}]}],t.ruleTypes=[{id:1,title:"页面"},{id:2,title:"点击"},{id:3,title:"订单"},{id:4,title:"购物车"},{id:5,title:"微信"},{id:6,title:"会员积分"},{id:7,title:"搜索"},{id:8,title:"活动"},{id:9,title:"优惠券"},{id:10,title:"中奖"},{id:11,title:"关联型"}],t.taskStatus=[{id:0,title:"未开始"},{id:1,title:"执行中"},{id:2,title:"暂停中"},{id:3,title:"已结束"},{id:4,title:"未加入"}],t.boolOptions=[{id:1,title:"震"},{id:2,title:"假"}],t.timeOptions=[{id:1,title:"开始时间"},{id:2,title:"结束时间"}],t.compareOptions=[{id:1,title:"大于"},{id:2,title:"小于等于"},{id:3,title:"小于"},{id:4,title:"小于等于"},{id:5,title:"等于"}],t.sexOptions=[{id:1,title:"男"},{id:2,title:"女"},{id:3,title:"保密"}],t.pointsOptions=[{id:1,title:"购买积分"},{id:2,title:"行为积分"}],t.couponOptions=[{id:1,title:"领取优惠券"},{id:2,title:"使用优惠券"}]},function(e,t){t.appState={name:"app",redirectTo:"tasksList",component:"app"}},function(e,t){t.otherwiseConfigBlock=["$urlRouterProvider",function(e){e.otherwise("/task")}],t.httpConfigBlock=["$httpProvider","dateServiceProvider",function(e,t){function n(e,t,r){if(t(e))return r(e);if(e instanceof File)return e;if(angular.isObject(e)){var i;return i=angular.isArray(e)?[]:{},angular.forEach(e,function(e,s){i[s]=n(e,t,r)}),i}return e}var r=t.$get();e.defaults.transformRequest=function(e,t){var n,r,i=[];for(n in e)r=e[n],i.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return i.join("&")},e.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"},e.interceptors.push(["$q",function(e){return{request:function(e){var t=/^http/.test(e.url);
return t?(e.params=n(e.params,angular.isDate,r.toString),e.data=n(e.data,angular.isDate,r.toString),e):e},response:function(t){var i=/^http/.test(t.config.url);if(!i)return t;var s=t.data,a=s&&s.Status,o=s&&s.Information,l=s&&s.Data||{};if(1==a){l=n(l,r.isDateString,r.fromString);var d=l.Data;return angular.isArray(d)&&(l.hasOwnProperty("count")&&(d.count=l.count),l=d),angular.isString(l)&&(l={Data:l}),l.Information=o,e.resolve(l)}return e.reject(o)}}}])}]},function(e,t){t.taskStatusFilter=["taskStatus",function(e){return function(t){if(!t)return"";var n=e.find(function(e){return e.id==t});return n&&n.title}}]},function(e,t){e.exports=["compareOptions",function(e){function t(t){t.model&&(t.model[t.key[0]]=e[0].id,t.model[t.key[3]]=e[0].id);var n=[{key:t.key[0],type:"select2",className:"col-sm-4",templateOptions:{labelClass:"col-sm-6",valueClass:"col-sm-6 pr-md-0",label:"触发次数",valueProp:"id",labelProp:"title",options:e}},{key:t.key[1],type:"input2",className:"col-sm-2",templateOptions:{labelClass:"hide",valueClass:"__",addonRight:{text:"次"}}},{key:t.key[2],type:"checkbox2",className:"col-sm-1 nowrap",templateOptions:{labelClass:"hide",valueClass:"ml15",label:"且"}},{key:t.key[3],type:"select2",className:"col-sm-2",templateOptions:{labelClass:"hide",valueClass:"__",valueProp:"id",labelProp:"title",options:e},expressionProperties:{"templateOptions.disabled":"!model."+t.key[2]}},{key:t.key[4],type:"input2",className:"col-sm-2",templateOptions:{labelClass:"hide",valueClass:"__",addonRight:{text:"次"}},expressionProperties:{"templateOptions.disabled":"!model."+t.key[2]}}];return{className:t.className||"row",fieldGroup:n}}function n(e){var t=[{key:e.key[0],type:"time2",className:"col-sm-6",templateOptions:{label:e.label,required:e.required},expressionProperties:{"templateOptions.maxDate":"model."+e.key[1]}},{key:e.key[1],type:"time2",className:"col-sm-6",templateOptions:{label:"至",required:e.required},expressionProperties:{"templateOptions.minDate":"model."+e.key[0]}}];return{className:e.className||"row",fieldGroup:t}}return{getCompare:t,getTimeRange:n}}]},function(e,t){},,function(e,t,n){var r=n(70),i=n(74),s=n(76),a=n(78),o=n(79);e.exports={components:{taskList:r,editTask:i,test:s},states:[a.taskListState,a.newTaskState,a.editTaskState,a.testState],factories:{tasksService:o.tasksService}}},function(e,t,n){function r(e,t,n,r){function i(){var t=l.model.timeOption,n=l.model.time||{},r={siteid:l.model.siteid,rulegroupname:l.model.rulegroupname,rulegrouptype:l.model.rulegrouptype,status:l.model.status,startdate:0==t&&n.min||null,startdate1:0==t&&n.max||null,enddate:1==t&&n.min||null,enddate1:1==t&&n.max||null};return e.getTasks(r)}function s(e){console.log("on table init"),l.update=e}function a(e){var t=n.find(function(t){return t.id==e});return t?t.title:""}function o(e){var t=parseFloat(e+"");return Math.round(100*t)}var l=this;l.store=r,l.data=[],l.update=null;var d=n.slice(0,-1);l.model={timeOption:0},l.options={},l.fields=[{className:"row",fieldGroup:[{key:"siteid",type:"input2",className:"col-sm-6 col-lg-3",templateOptions:{label:"site ID/广告ID"}},{key:"rulegroupname",type:"input2",className:"col-sm-6 col-lg-3",templateOptions:{label:"规则组名称"}},{key:"rulegrouptype",type:"select2",className:"col-sm-6 col-lg-3",templateOptions:{label:"规则组类型",valueProp:"id",labelProp:"title",options:[{id:void 0,title:"全部"}].concat(t)}},{key:"status",type:"select2",className:"col-sm-6 col-lg-3",templateOptions:{label:"任务状态",valueProp:"id",labelProp:"title",options:[{id:void 0,title:"全部"}].concat(d)}}]},{className:"row",fieldGroup:[{key:"timeOption",type:"select",className:"col-sm-2",templateOptions:{label:"",valueProp:"id",labelProp:"title",options:[{id:0,title:"开始时间"},{id:1,title:"结束时间"}]}},{key:"time",type:"timeRange",className:"col-sm-8 col-md-6 pl30",templateOptions:{label:""}}]}],l.tableConfig={data:[],firstUpdate:!0,getData:i,columns:[{head:"site ID/广告ID",data:"{{ row.SiteID }}"},{head:"规则组名称",data:"{{ row.RuleGroupName }}"},{head:"规则组类型",data:"{{ row.RuleGroupType }}"},{head:"开始时间",data:"{{ row.StartDate | date2 }}"},{head:"结束时间",data:"{{ row.EndDate | date2 }}"},{head:"状态",data:"{{ methods.getStatusTitle(row.Status) }}"},{head:"任务进度",data:'<div class="text-center">{{methods.getPercent(row.Percentage)}}%</div><uib-progressbar value="methods.getPercent(row.Percentage)" type="success"></uib-progressbar>'},{head:"创建时间",data:"{{ row.CreateTime | date2 }}"},{head:"操作",data:'<a ui-sref="editTask({taskId: row.TaskID})" ng-show="row.Status==0||row.Status==2">编辑任务时间</a>'}],methods:{getStatusTitle:a,getPercent:o}},l.onTableInit=s}n(71),r.$inject=["tasksService","rulesTypes","taskStatus","store"],e.exports={template:n(73),controller:r}},function(e,t){},,function(e,t){e.exports='<div class="task-list">\r\n  <!-- 筛选 -->\r\n  <div class="well well-default">\r\n    <form class="form-horizontal" name="$ctrl.form" novalidate>\r\n      <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n      </formly-form>\r\n      <button class="btn btn-success" ng-click="$ctrl.update()">筛选</button>\r\n      <button class="btn btn-default" ng-click="$ctrl.options.resetModel()">重置</button>  \r\n    </form>\r\n    <!-- <div>{{ $ctrl.model | json }}</div> -->\r\n  </div>\r\n  <p><a ui-sref="newTask" class="btn btn-success">新建任务</a></p>\r\n  <!-- 任务列表 -->\r\n<!--   <table class="table table-bordered table-hover">\r\n    <thead class="bg-default">\r\n      <tr>\r\n        <td>site ID/广告ID</td>\r\n        <td>规则组名称</td>\r\n        <td>规则组类型</td>\r\n        <td>开始时间</td>\r\n        <td>结束时间</td>\r\n        <td>状态</td>\r\n        <td ng-hide="$ctrl.store.hideEditArea">任务进度</td>\r\n        <td>创建时间</td>\r\n        <td>操作</td>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="row in $ctrl.data">\r\n        <td>{{ row.SiteID }}</td>\r\n        <td>{{ row.RuleGroupName }}</td>\r\n        <td>{{ row.RuleGroupType }}</td>\r\n        <td>{{ row.StartDate | date2 }}</td>\r\n        <td>{{ row.EndDate | date2 }}</td>\r\n        <td>\r\n          {{ row.StatusTitle }}\r\n          <span  ng-hide="$ctrl.store.hideEditArea" ng-if="row.Status==1 || row.Status==2">\r\n            <switch name="enabled" ng-model="enabled" class="green"></switch></div>\r\n          </span>\r\n        </td>\r\n        <td ng-hide="$ctrl.store.hideEditArea">\r\n          <div class="text-center">22%</div>\r\n          <uib-progressbar value="22"></uib-progressbar>\r\n        </td>\r\n        <td>{{ row.CreateTime | date2 }}</td>\r\n        <td>\r\n          <a ui-sref="editTask({taskId: row.TaskID})">编辑任务时间</a>\r\n        </td>\r\n      </tr>\r\n      <tr ng-if="!$ctrl.data.length" class="text-center">\r\n        <td colspan="9">空</td>\r\n      </tr>\r\n    </tbody>\r\n  </table> \r\n\r\n  <div class="hr"></div> -->\r\n  <xx-table config="$ctrl.tableConfig" on-init="$ctrl.onTableInit(update)"></xx-table>\r\n<!--   <div ng-init="bigTotalItems=175;bigCurrentPage=1;maxSize=3;"></div>\r\n  <ul uib-pagination \r\n    total-items="bigTotalItems" \r\n    ng-model="bigCurrentPage" \r\n    max-size="maxSize" \r\n    boundary-link-numbers="true" \r\n    previous-text="上一页" next-text="下一页"\r\n  ></ul> --> \r\n</div>\r\n\r\n'},function(e,t,n){function r(e,t,n,e){function r(){if(!s.form.$invalid){var t={RuleGroupID:s.model.RuleGroupID,TaskID:s.model.TaskID,SiteID:s.model.SiteID,StartDate:s.model.time.min,EndDate:s.model.time.max};return o?n.createTask(t).then(function(t){e.alert({content:"创建成功",hideCancel:!0}).then(i)},function(t){e.alert({content:t})}):n.editTask(t).then(function(t){e.alert({content:"修改成功",hideCancel:!0}).then(i)},function(t){t&&t.status==-1&&(t="您已离线"),e.alert({content:t})})}}function i(){t.go("tasksList")}var s=this;s.options={formState:{hideSiteId:!1}},s.fields=[],s.model={},s.submit=r,s.data={};var a=[],o=t.is("newTask");o?(s.model.ruleType=1,s.fields=[{key:"RuleGroupID",type:"select2",templateOptions:{label:"选择标签规则组",valueProp:"RuleGroupID",labelProp:"RuleGroupName",options:[],required:!0},controller:["$scope","rulesService",function(e,t){t.getRules({Status:4}).then(function(t){a=t||[],e.to.options=a,a.length&&(e.model.RuleGroupID=a[0].RuleGroupID)})}],watcher:{listener:function(e,t,n,r,i){if(t){var s=(a||[]).find(function(e){return e.RuleGroupID==t});if(s){var o=s.RuleGroupType;"网站"===o||"广告"===o?r.options.formState.hideSiteId=!1:r.options.formState.hideSiteId=!0}}}}},{key:"SiteID",type:"input2",hideExpression:"formState.hideSiteId",templateOptions:{label:"site ID/广告ID"},expressionProperties:{"templateOptions.required":"!formState.hideSiteId"}},{key:"time",type:"timeRange2",templateOptions:{label:"设置任务周期",required:!0}}]):n.getTasks({HYUniqueid:t.params.taskId}).then(function(e){var t=e&&e.length?e[0]:{};s.data=t,s.model={TaskID:t.TaskID,time:{min:t.StartDate,max:t.EndDate}},s.fields=[{type:"static2",templateOptions:{label:"标签规则组",text:t.RuleGroupName}},{type:"static2",hideExpression:"!model.SiteID",templateOptions:{label:"site ID/广告ID",text:t.SiteID}},{key:"time",type:"timeRange2",templateOptions:{label:"设置任务周期",required:!0}}]})}r.$inject=["$modalService","$state","tasksService","$modalService"],e.exports={template:n(75),controller:r}},function(e,t){e.exports='<div class="well well-default">\r\n  <form class="form-horizontal" name="$ctrl.form" novalidate style="max-width: 680px;">\r\n    <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n    </formly-form>\r\n    <div class="text-right">\r\n      <button type="submit" class="btn btn-success" xx-click="$ctrl.submit()">保存</button>\r\n      <button type="button" class="btn btn-default" ng-click="$ctrl.options.resetModel()">重置</button>  \r\n    </div>\r\n  </form>  \r\n</div>'},function(e,t,n){function r(e,t,n,r){var i=this;this.day=new Date,this.maxDate=new Date(2016,11,20),this.range={min:new Date(2016,10,3),max:new Date(2016,10,27)},i.click=function(){return console.log("controller: click"),t(function(){},1e3).then(function(){console.log("controller: resolve")})},i.model={input:[]},i.options={};var s=[];i.fields=[{className:"",fieldGroup:s},r.getCompare({model:i.model,key:["a","b","c","d","e"]}),r.getTimeRange({label:"time-range",required:!0,key:["minDate","maxDate"]})],i.addInput=function(){var e={key:"input["+s.length+"]",type:"input2",templateOptions:{label:"input"+s.length}};s.push(e)},i.removeInput=function(e){e>=s.length||(i.model.input.splice(e,1),s.pop())}}r.$inject=["tasksService","$timeout","$q","fieldOptionsService"],e.exports={template:n(77),controller:r}},function(e,t){e.exports='<button class="btn btn-success" xx-click="$ctrl.click()">点击</button>\r\n\r\n<form action="" class="form-horizontal">\r\n  <datetime-picker ng-model="$ctrl.day" max-date="$ctrl.maxDate" mode="{{$ctrl.mode}}"></datetime-picker>\r\n  <p>{{ $ctrl.day }}</p>\r\n\r\n  <datetime-range ng-model="$ctrl.range" mode="{{$ctrl.mode}}"></datetime-range>\r\n  <p>{{ $ctrl.range }}</p>\r\n\r\n  <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n    </formly-form>\r\n</form>\r\n<pre>{{ $ctrl.model | json }}</pre>\r\n<button class="btn btn-primary" ng-click="$ctrl.alert()">打开</button>\r\n\r\n\r\n<div class="btn btn-primary" ng-click="$ctrl.addInput()">添加一个input</div>\r\n<div class="btn btn-primary" ng-click="$ctrl.removeInput(0)">删除第1个input</div>\r\n\r\n'},function(e,t){t.taskListState={parent:"app",name:"tasksList",url:"/task",title:"任务列表",component:"taskList"},t.newTaskState={parent:"app",name:"newTask",url:"/task/new",title:"新建任务列表",component:"editTask"},t.editTaskState={parent:"app",name:"editTask",url:"/task/:taskId/edit",title:"编辑任务列表",component:"editTask"},t.testState={parent:"app",name:"test",url:"/test",title:"测试",component:"test"}},function(e,t){function n(e,t,n){function r(e){return e=e||{},t.get(n+"/task/api/findtask",{params:e})}function i(e){var r={RuleGroupID:e.RuleGroupID,SiteID:e.SiteID,StartDate:e.StartDate,EndDate:e.EndDate};return t.post(n+"/task/api/task",r)}function s(e){var r={HYUniqueID:e.TaskID,StartDate:e.StartDate,EndDate:e.EndDate};return t.post(n+"/task/api/task?method=1",r)}return{getTasks:r,createTask:i,editTask:s}}n.$inject=["$q","$http","apiBaseUrl"],t.tasksService=n},function(e,t,n){var r=n(81),i=n(85),s=n(87),a=n(89),o=n(91),l=n(95),d=n(97),c=n(99),u=n(101),p=n(102),m=n(109),f=n(110);e.exports={components:{rulesList:a,viewRulesList:l,viewRules:o,newRules:s,newRuleList:i,newRule:r,importRules:d,importRulesModal:c},states:[u.rulesListState,u.newRulesState,u.newRuleListState,u.newRuleState,u.viewRulesListState,u.viewRulesState,u.importRuleState],factories:{rulesService:m.rulesService,newRulesOptionsService:f},runBlocks:[p.runFormlyConfig]}},function(e,t,n){function r(e,t,n){function r(){s.formList.push({options:{},model:{},fields:angular.copy(s.fields)})}function i(e){s.formList.splice(e,1)}var s=this;s.ruleTypes=e,s.model={},s.fields=[],s.formList=[],s.addSection=r,s.removeSection=i,s.fields=n.get({id:101,model:s.model}),r(),s.formList[0].model={}}n(82),r.$inject=["ruleTypes","$state","newRulesOptionsService"],e.exports={template:n(84),controller:r}},function(e,t){},,function(e,t){e.exports='<div>\r\n\t<div class="btn btn-default">提交规则组</div>\r\n</div>\r\n<div class="well" ng-repeat="form in $ctrl.formList track by $index">\r\n\t<button class="close" ng-click="$ctrl.removeSection($index)">&times;</button>\r\n\t<form class="form-horizontal" name="form.form" novalidate style="max-width: 680px;">\r\n\t\t<div class="text-right">\r\n      <button class="btn btn-default">保存</button>\r\n"\r\n      <button class="btn btn-default" ng-click="form.options.resetModel()">清除规则</button>\r\n    </div>\r\n    <formly-form model="form.model" fields="form.fields" form="form.form" options="form.options">\r\n    </formly-form>\r\n  </form>\t\r\n  <pre>{{ form.model | json}}</pre>\r\n  <pre>{{ form.form | json}}</pre>\r\n</div>\r\n<div>\r\n\t<button class="btn btn-default" ng-click="$ctrl.addSection()">\r\n\t\t<span class="glyphicon glyphicon-plus-sign"></span>添加规则</button>\r\n</div>'},function(e,t,n){function r(e,t){function n(){r.ruleTypes=t.getRuleTypes("网站"),e.is("newRuleList")&&r.ruleTypes.length&&e.go("newRule",{ruleType:r.ruleTypes[0].id})}var r=this;r.ruleTypes=[];e.params.rulesId;n()}n(82),r.$inject=["$state","rulesService"],e.exports={template:n(86),controller:r}},function(e,t){e.exports='<div class="new-rule">\r\n\t<div class="app-main-nav">\r\n    <ul class="nav nav-pills nav-stacked">\r\n      <li ui-sref-active="active" ng-repeat="type in $ctrl.ruleTypes">\r\n      \t<a ui-sref="{ruleType: type.id}">{{ type.title }}</a>\r\n      </li>\r\n    </ul>\r\n\t</div>\r\n\t<div class="app-main-content">\r\n\t\t<ui-view class="app-ui-view"></ui-view>\r\n\t</div>\r\n</div>'},function(e,t,n){function r(e,t,n){var r=this;r.options={},r.model={rulesType:t[0].id},r.fields=[{key:"rulesType",type:"select2",templateOptions:{label:"选择规则组类型",valueProp:"id",labelProp:"title",options:t,required:!0}},{key:"asdf",type:"input2",hideExpression:'model.rulesType!=="网站"',templateOptions:{label:"site ID（选填）"}},{key:"asdf",type:"input2",hideExpression:'model.rulesType!=="广告"',templateOptions:{label:"广告ID（选填）"}},{key:"ffff",type:"input2",templateOptions:{label:"规则组名称",required:!0}}],r.go=function(){e.go("newRuleList",{rulesId:"test"})}}r.$inject=["$state","rulesTypes","ruleTypes"],e.exports={template:n(88),controller:r}},function(e,t){e.exports='<div class="well well-default new-rules">\r\n  <form class="form-horizontal" ng-submit="$ctrl.onSubmit()" name="$ctrl.form" novalidate style="max-width: 680px;">\r\n    <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n    </formly-form>\r\n    <div class="row">\r\n      <div class="col-sm-8 col-sm-offset-4">\r\n        <button type="submit" class="btn btn-success" ng-disabled="$ctrl.form.$invalid">下一步</button>\r\n        创建规则组，去设置标签规则\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <p><a ng-click="$ctrl.go()">测试用：创建规则</a></p>\r\n</div>\r\n'},function(e,t,n){function r(e,t){function n(t,n){return function(){return e.getRules({Status:t})}}var r=this;r.store=t,r.data=[],r.rulesTitles=[{id:0,title:"加入任务-未开启"},{id:1,title:"加入任务-执行中"},{id:2,title:"加入任务-暂停中"},{id:3,title:"加入任务-已结束"},{id:4,title:"未加入任务"}];var i={data:[],firstUpdate:!0,columns:[{head:"site ID/广告ID",data:"{{ row.SiteID }}"},{head:"规则组名称",data:'<a ui-sref="viewRules({rulesId: row.RuleGroupID})">{{ row.RuleGroupName }}</a>'},{head:"规则组类型",data:"{{ row.RuleGroupType }}"},{head:"创建时间",data:"{{ row.CreateTime | date2 }}"},{head:"加入任务时间",data:"{{ row.JoinTaskTime | date2 }}"},{hide:t.hideEditArea,head:" ",data:'<a href="">复制规则组</a><br><a href="">导入规则组</a>'}]};r.tableConfigs=[],r.rulesTitles.forEach(function(e,t){var s=n(e.id,t);r.tableConfigs[t]=angular.extend({},i,{getData:s})})}r.$inject=["rulesService","store"],e.exports={template:n(90),controller:r}},function(e,t){e.exports='<div class="rules-list">\r\n  <div ng-repeat="rules in $ctrl.rulesTitles">\r\n    <div class="panel panel-default" ng-init="rules.isCollapsed=false">\r\n      <div class="panel-heading">\r\n        {{ rules.title }}\r\n        <button class="btn btn-link pull-right" ng-click="rules.isCollapsed = !rules.isCollapsed">\r\n          <span class="glyphicon" ng-class="{\'glyphicon-menu-down\': rules.isCollapsed, \'glyphicon-menu-up\': !rules.isCollapsed}"></span>\r\n        </button>\r\n      </div>\r\n      <div uib-collapse="rules.isCollapsed">\r\n        <div class="panel-body">\r\n          <xx-table config="$ctrl.tableConfigs[$index]"></xx-table>\r\n          <!-- <table class="table table-bordered table-hover">\r\n            <thead class="bg-default">\r\n              <tr>\r\n                <td>site ID/广告ID</td>\r\n                <td>规则组名称</td>\r\n                <td>规则组类型</td>\r\n                <td>创建时间</td>\r\n                <td>加入任务时间</td>\r\n                <td ng-hide="$ctrl.store.hideEditArea">&nbsp;</td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr ng-repeat="row in $ctrl.data[$index]">\r\n                <td>{{ row.SiteID }}</td>\r\n                <td>{{ row.RuleGroupName }}</td>\r\n                <td>{{ row.RuleGroupType }}</td>\r\n                <td>{{ row.CreateTime | date2 }}</td>\r\n                <td>{{ row.CreateTaskTime | date2 }}</td>\r\n                <td ng-hide="$ctrl.store.hideEditArea">\r\n                  <a href="">复制规则组</a>\r\n                  <br>\r\n                  <a href="">导入规则组</a>\r\n                </td>\r\n              </tr>\r\n              <tr ng-if="!$ctrl.data[$index].length">\r\n                <td colspan="6" class="text-center">空</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>   -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>'},function(e,t,n){function r(e,t,n,r){function i(){a=r.defer(),t.getRule(l,{timeout:a.promise}).then(function(e){o.loading=1,e&&(o.data=e,n.viewRulesType="已加入任务"==e.GroupStatus?1:4,o.ruleTypes=t.getRuleTypes(e.GroupType),(e.Module||[]).forEach(function(e){var t=o.ruleTypes.find(function(t){return t.title==e.Name});console.log(e.Name),t&&(t.rules=(t.rules||[]).concat(e.Content))}),o.tableConfigs=o.ruleTypes.map(function(e,t){return angular.extend({},d,{data:e.rules||[]})}))},function(e){o.loading=2,o.loadingError=e})}function s(){a&&a.resolve()}var a,o=this,l=e.params.rulesId;o.data={},o.ruleTypes=[],o.store=n,o.$onDestroy=s,o.loading=0,o.loadingError="";var d={data:[],columns:[{head:"Key",data:'<span uib-tooltip-html="row.Tips">{{ row.Key }}</span>'},{head:"Tag",data:'<div ng-bind-html="row.Tag"></div>'},{head:"权重",data:'<div ng-bind-html="row.Weight"></div>'},{head:"执行次数",data:'<div ng-bind-html="row.ExecCount"></div>'},{hide:n.hideEditArea,head:'状态 <button class="btn btn-sm btn-success" ng-hide="$ctrl.store.hideEditArea">保存</button>',data:"{{ row.Status }}"}]};i()}n(92),r.$inject=["$state","rulesService","store","$q"],e.exports={template:n(94),controller:r}},function(e,t){},,function(e,t){e.exports='<div class="text-center" ng-show="$ctrl.loading==0">正在统计，请稍候......</div>\r\n<div class="text-center" ng-show="$ctrl.loading==2">\r\n  加载失败，{{$ctrl.loadingError}}。\r\n  <a ui-sref="rulesList">返回规格组列表&gt;&gt;</a>\r\n</div>\r\n<div class="view-rules" ng-show="$ctrl.loading==1">\r\n  <div class="clearfix" ng-hide="$ctrl.store.hideEditArea">\r\n    <button class="btn btn-success pull-right">导出规则组</button>\r\n  </div>\r\n  <dl class="dl-horizontal">\r\n    <dt>规则组类型：</dt>\r\n    <dd>{{ $ctrl.data.GroupType }}</dd>\r\n    <dt>site ID：</dt>\r\n    <dd>{{ $ctrl.data.SiteID }}</dd>\r\n    <dt>规则组名称：</dt>\r\n    <dd>{{ $ctrl.data.GroupName }}</dd>\r\n    <dt>规则组状态：</dt>\r\n    <dd>{{ $ctrl.data.GroupStatus }}</dd>\r\n    <dt>加入任务时间：</dt>\r\n    <dd>{{ $ctrl.data.JoinTaskTime | date2 }}</dd>\r\n    <dt>创建时间：</dt>\r\n    <dd>{{ $ctrl.data.CreateTime | date2 }}</dd>\r\n  </dl>  \r\n  <div ng-repeat="ruleType in $ctrl.ruleTypes">\r\n    <div class="panel panel-default" ng-init="ruleType.isCollapsed=false" ng-show="ruleType.rules.length">\r\n      <div class="panel-heading">\r\n        {{ ruleType.title }}\r\n        <button class="btn btn-link pull-right" ng-click="ruleType.isCollapsed = !ruleType.isCollapsed">\r\n          <span class="glyphicon" ng-class="{\'glyphicon-menu-down\': ruleType.isCollapsed, \'glyphicon-menu-up\': !ruleType.isCollapsed}"></span>\r\n        </button>\r\n        <button class="btn btn-sm btn-success pull-right" ng-hide="$ctrl.store.hideEditArea">添加规则</button>\r\n      </div>\r\n      <div uib-collapse="ruleType.isCollapsed">\r\n        <div class="panel-body">\r\n          <xx-table config="$ctrl.tableConfigs[$index]"></xx-table>\r\n          <!-- <table class="table table-bordered table-hover">\r\n            <thead class="bg-default">\r\n              <tr>\r\n                <td>Key</td>\r\n                <td>Tag</td>\r\n                <td>权重</td>\r\n                <td>执行次数</td>\r\n                <td>\r\n                  状态\r\n                  <button class="btn btn-sm btn-success" ng-hide="$ctrl.store.hideEditArea">保存</button>\r\n                </td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr ng-repeat="row in ruleType.rules">\r\n                <td>\r\n                  <span uib-tooltip-html="row.Tips">{{ row.Key }}</span>\r\n                </td>\r\n                <td ng-bind-html="row.Tag"></td>\r\n                <td>{{ row.Weight }}</td>\r\n                <td>{{ row.ExecCount }}</td>\r\n                <td>\r\n                  {{ row.Status }}\r\n                </td>\r\n              </tr>\r\n              <tr ng-if="!ruleType.rules.length">\r\n                <td colspan="5" class="text-center">空</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>   -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>'},function(e,t,n){function r(e,t,n,r,i,s){function a(){if(console.log("view rules list INIT"),n.is("viewRules")){var t=n.params.rulesId,r=o.data.findIndex(function(e){return console.log(e.RuleGroupID),t==e.RuleGroupID});console.log(r),o.showNav=r>=0,o.currentId=t}else o.showNav=!0,o.data.length&&(o.currentId=o.data[0].RuleGroupID,n.go("viewRules",{rulesId:o.data[0].RuleGroupID}));e.$emit("VIEW_RULES_TYPE",o.showNav?1:2)}var o=this;o.data=[],o.store=s,o.showNav=!1,o.currentId="",i.getRules({Status:1}).then(function(e){o.data=e||[],o.data.forEach(function(e){var t="";e.SiteID&&(t+=e.SiteID+" - "),t+=e.RuleGroupName,e.title=t}),a()});var l=r.onSuccess({},function(){a()});o.$onDestroy=function(){l()},t.$watch("$ctrl.currentId",function(){o.currentId&&n.go("viewRules",{rulesId:o.currentId})})}r.$inject=["$rootScope","$scope","$state","$transitions","rulesService","store"],e.exports={template:n(96),controller:r}},function(e,t){e.exports='<ui-select ng-model="$ctrl.currentId" ng-show="$ctrl.showNav"\r\n       theme="bootstrap"\r\n       title="">\r\n  <ui-select-match>{{$select.selected.title}}</ui-select-match>\r\n  <ui-select-choices repeat="row.RuleGroupID as row in $ctrl.data | filter: $select.search">\r\n    <div>{{ row.title }}</div>\r\n  </ui-select-choices>\r\n</ui-select>\r\n<div style="height:15px;"></div>\r\n<!-- <ul class="nav nav-tabs" style="margin-bottom:-1px;" ng-show="$ctrl.showNav">\r\n  <li ng-repeat="row in $ctrl.data track by $index" ui-sref-active="active">\r\n    <a ui-sref="viewRules({ rulesId: row.RuleGroupID })">\r\n      <span ng-hide="!row.SiteID">\r\n        {{ row.SiteID }}-\r\n      </span>\r\n      {{ row.RuleGroupName }}\r\n    </a>\r\n  </li>\r\n</ul> -->\r\n<div class="panel panel-default">\r\n  <div class="panel-body">\r\n    <ui-view></ui-view>\r\n  </div>\r\n</div>'},function(e,t,n){function r(e,t){function n(e){i.uploading||(i.errMsg="",i.succMsg="",i.uploading=!0,t.importFile(e).then(function(e){i.uploading=!1,i.succMsg=e.Information,i.rulesId=e.Data},function(e){i.uploading=!1,i.errMsg=e}))}function r(){var t=e.open({size:"400",component:"importRulesModal"});t.result.then(function(e){console.log("xxxxxxxxxxxxxx"),console.log(e)})}var i=this;i.selectFile=n,i.showImportModal=r,i.errMsg="",i.succMsg="",i.rulesId="",i.uploading=!1}r.$inject=["$uibModal","rulesService"],e.exports={template:n(98),controller:r}},function(e,t){e.exports='<div style="min-height: 200px;">\r\n  <!-- 打开弹窗选择文件 -->\r\n  <p class="hide">\r\n    <button class="btn btn-primary" ng-click="$ctrl.showImportModal()">\r\n      导入规则组\r\n    </button>\r\n  </p>\r\n  <!-- 直接选择文件 -->\r\n  <p>\r\n    <input-file class="btn btn-primary" on-change="$ctrl.selectFile(file)" accept=".xls,.xlsx" ng-disabled="$ctrl.uploading"> \r\n      选择文件\r\n    </input-file>\r\n  </p>\r\n  <p class="text-warn hide">\r\n    数据上传中47%\r\n  </p>\r\n  <p ng-show="$ctrl.succMsg">\r\n    导入成功：{{ $ctrl.succMsg }}\r\n    <a  ui-sref="viewRules({rulesId: $ctrl.rulesId})">查看规则组详情&gt;&gt;</a>\r\n  </p>\r\n  <p ng-show="$ctrl.errMsg">\r\n    导入失败：{{ $ctrl.errMsg }}\r\n  </p>\r\n</div>\r\n<div class="hide">\r\n  <h5>导入规则组历史</h5>\r\n  <div class="hr"></div>\r\n  <div style="text-align:center;line-height:200px;">暂无导入规则组历史</div>\r\n  <table class="table table-bordered table-hover">\r\n    <thead class="bg-default">\r\n      <tr>\r\n        <th>导入时间</th>\r\n        <th>导入结果</th>\r\n        <th>规则组名称</th>\r\n        <th>规则模块</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td>2016-10-27  10:55:23</td>\r\n        <td>导入失败</td>\r\n        <td>Arla官网打标签规则</td>\r\n        <td>点击</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>'},function(e,t,n){function r(e){var t=this,n=[{id:1,label:"Option 1"},{id:2,label:"Option 2"},{id:3,label:"Option 3"}],r=[{id:1,label:"页面"},{id:2,label:"点击"},{id:3,label:"订单"},{id:4,label:"购物车"},{id:5,label:"会员"},{id:6,label:"微信"},{id:7,label:"会员积分"},{id:8,label:"搜索"},{id:9,label:"活动"},{id:10,label:"优惠卷"},{id:11,label:"中奖"},{id:12,label:"答题"}];t.model={selectRules:n[0].id,selectModule:r[0].id},t.options={},t.fields=[{key:"selectRules",type:"select2",templateOptions:{label:"选择标签规则组",valueProp:"id",labelProp:"label",options:n,required:!0}},{key:"selectModule",type:"select2",templateOptions:{label:"选择网站模块",valueProp:"id",labelProp:"label",options:r,required:!0}}],t.selectFile=function(e){t.close({$value:e})}}r.$inject=["$scope"],e.exports={template:n(100),controller:r,bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(e,t){e.exports='<div class="modal-body">\r\n  <form class="form-horizontal" name="$ctrl.form" novalidate>\r\n    <formly-form model="$ctrl.model" fields="$ctrl.fields" form="$ctrl.form" options="$ctrl.options">\r\n  </formly-form>\r\n  </form>\r\n</div>\r\n<div class="modal-footer">\r\n  <input-file class="btn btn-primary" on-change="$ctrl.selectFile(file)">选择文件</input-file>\r\n  <button class="btn btn-default" type="button" ng-click="$ctrl.dismiss();">取消</button>\r\n</div>'},function(e,t){t.rulesListState={parent:"app",name:"rulesList",url:"/rules",title:"规则组列表",component:"rulesList"},t.newRulesState={parent:"app",name:"newRules",url:"/rules/new",title:"新建规则组",component:"newRules"},t.viewRulesListState={parent:"app",name:"viewRulesList",url:"/rules/view",title:"规则组详情",component:"viewRulesList"},t.viewRulesState={parent:"viewRulesList",name:"viewRules",url:"/:rulesId",title:"规则组详情",component:"viewRules"},t.newRuleListState={parent:"app",name:"newRuleList",url:"/rules/:rulesId/rule",title:"新建规则组",component:"newRuleList"},t.newRuleState={parent:"newRuleList",name:"newRule",url:"/:ruleType",title:"新建规则组",component:"newRule"},t.importRuleState={parent:"app",name:"importRules",url:"/rule/import",title:"导入规则组",component:"importRules"}},function(e,t,n){t.runFormlyConfig=["formlyConfig","formlyValidationMessages",function(e,t){e.setType(n(103)),e.setType(n(107))}]},function(e,t,n){n(104);var r=0;e.exports={name:"bindTag",template:n(106),defaultOptions:{noFormControl:!1},controller:["$scope","$timeout",function(e,t){function n(e){return{key:d+"["+e+"].weight",type:"input2",templateOptions:{labelClass:"hide",valueClass:"__",hideLabel:!0,required:!0}}}function i(e,n){return t(function(){o=n.templateOptions.options=[{id:1,title:"aaa"},{id:2,title:"bbb"},{id:3,title:"ccc"},{id:4,title:"ddd"},{id:5,title:"eee"},{id:6,title:"fff"}]},1e3)}function s(t){l[d]=l[d]||[],l[d].push({weight:"",tagId:t.id,tagTitle:t.title}),e.hideModel[c]=void 0}function a(e){l[d].splice(e,1),u&&u.$validate()}var o,l=e.model,d=e.options.key;e.selectTag=s,e.removeTag=a,e.copyItemOptions=n;var c="bindTagSearch-"+r++,u=null;e.hideModel={},e.hideFields=[{key:c,type:"uiSelectAsync2",templateOptions:{labelClass:"col-sm-2",valueClass:"col-sm-10",optionsAttr:"bs-options",label:"关联标签",options:[],valueProp:"id",labelProp:"title",refresh:i,refreshDelay:100},validators:{required:function(n,r){console.log("custom validators"),n&&s(n),t(function(){delete e.hideModel[c]},100);var i=l[d];return i instanceof Array&&i.length>0}},controller:["$scope",function(e){var t=e.$watch("fc",function(e){e&&(u=e,t())})}]}]}]}},function(e,t){},,function(e,t){e.exports='<div class="bind-tag">\r\n  <formly-form fields="hideFields" model="hideModel" form="form">\r\n  </formly-form>\r\n  <div ng-show="model[options.key].length">\r\n    <div class="clearfix text-center" style="margin-bottom:15px">\r\n      <div class="col-xs-3">权重</div>\r\n      <div class="col-xs-9">已选标签</div>\r\n    </div>\r\n    <div class="clearfix"\r\n         ng-repeat="item in model[options.key] track by $index"\r\n         ng-init="itemOptions = copyItemOptions($index)">\r\n      <div class="col-xs-3">\r\n        <formly-field class="no-padding"\r\n                      options="itemOptions"\r\n                      model="model"\r\n                      form="form">\r\n        </formly-field>\r\n      </div>\r\n      <div class="col-xs-9" style="line-height: 32px;">\r\n        <div>\r\n          {{ model[options.key][$index].tagTitle }}\r\n          <a ng-click="removeTag($index)">\r\n            <span class="glyphicon glyphicon-trash"></span>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </div>  \r\n  </div>\r\n</div>'},function(e,t,n){e.exports={name:"countRange",template:n(108),controller:["$scope","compareOptions",function(e,t){var n=(e.model,e.options.key);e.countFields=[{key:n+".w1",type:"select2",className:"col-sm-4",templateOptions:{labelClass:"col-sm-6",valueClass:"col-sm-6 pr0",label:"触发次数",valueProp:"id",labelProp:"title",options:t}},{key:n+".w2",type:"input2",className:"col-sm-2",templateOptions:{labelClass:"hide",valueClass:"__",addonRight:{text:"次"}}},{key:n+".w3",type:"checkbox2",className:"col-sm-1 nowrap",templateOptions:{labelClass:"hide",valueClass:"ml15",label:"且"}},{key:n+".w4",type:"select2",className:"col-sm-2",templateOptions:{labelClass:"hide",valueClass:"__",valueProp:"id",labelProp:"title",options:t},expressionProperties:{"templateOptions.disabled":"!model."+n+".w3"}},{key:n+".w5",type:"input2",className:"col-sm-2",
templateOptions:{labelClass:"hide",valueClass:"__",addonRight:{text:"次"}},expressionProperties:{"templateOptions.disabled":"!model."+n+".w3"}}]}]}},function(e,t){e.exports='<div class="row">\r\n  <formly-form fields="countFields" model="model" form="form">\r\n  </formly-form>\r\n</div>'},function(e,t){function n(e,t,n,r){function i(e,r){return r=r||{},r.params=e,t.get(n+"/task/api/findrulegroup",r)}function s(e,r){return r=r||{},t.get(n+"/task/api/TaskDetail/"+e,r)}function a(e){var t=r.find(function(t){return t.title===e});return t?angular.copy(t.types):[]}function o(e){var r={pic:e};return t.post(n+"/rule/api/RuleImport",r,{headers:{"Content-Type":void 0},transformRequest:function(e,t){console.log(e);var n=new FormData;return angular.forEach(e,function(e,t){n.append(t,e)}),n}})}return{getRules:i,getRule:s,getRuleTypes:a,importFile:o}}n.$inject=["$q","$http","apiBaseUrl","rulesTypes"],t.rulesService=n},function(e,t,n){var r={101:n(111)};e.exports=["compareOptions","fieldOptionsService",function(e,t){function n(e){var t=e.id,n=e.model;return r[t](i,n)}var i={compareOptions:e,fieldOptionsService:t};return{get:n}}]},function(e,t){e.exports=function(e,t){var n=(e.compareOptions,e.fieldOptionsService);return[{key:"url",type:"input2",templateOptions:{labelClass:"col-sm-2",valueClass:"col-sm-10",label:"URL",required:!0}},{key:"title",type:"input2",templateOptions:{labelClass:"col-sm-2",valueClass:"col-sm-10",label:"Title",required:!0}},{key:"statistic",type:"checkbox2",templateOptions:{labelClass:"col-sm-2",valueClass:"col-sm-10",label:"统计型"}},{key:"statisticArray",type:"repeatSection",templateOptions:{btnText:"Add another investment",fields:[{key:"time",type:"timeRange2",templateOptions:{label:"统计周期"}},{key:"time",type:"countRange",templateOptions:{label:"统计周期"}},{key:"test2",type:"bindTag",templateOptions:{required:!0}}]}},n.getTimeRange({label:"统计周期",required:!0,key:["minDate","maxDate"]}),{key:"time",type:"timeRange2",templateOptions:{labelClass:"col-sm-2",valueClass:"col-sm-10",label:"统计周期"}},{key:"test2",type:"bindTag",templateOptions:{required:!0}},{key:"count22",type:"countRange"}]}}]);
//# sourceMappingURL=app.js.map