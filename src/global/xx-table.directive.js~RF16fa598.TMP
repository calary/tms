directive.$inject = ['$timeout', '$q'];
function directive($timeout, $q){

	return {
		retrict: 'AE',
		scope: {
			
		},
		template: require('./xx-table.directive.html'),
		link: function($scope, $ele, $attr){
			// 0 初始
      // 1 已请求
      // 2 请求失败
      // 3 请求成功 
      $scope.status = 0;
      $scope.data = [];
      $scope.getData = getData;



      function getData(){
        $scope.status = 1;
        $timeout(function(){
          $scope.status = 2;
          $scope.data = [{"SiteID":"1555","RuleGroupName":"测试规则组1","RuleGroupType":"呼叫中心","StartDate":"2016-09-22T19:17:05","EndDate":"2016-08-25T17:17:05","Status":3,"CreateTime":"2016-11-04T15:39:08","RuleGroupID":"c4fc8001-a261-11e6-8096-06fab88a43c4","TaskID":"08db268a-afbd-11e6-8096-06fab88a43c3"},{"SiteID":"1542","RuleGroupName":"测试规则组","RuleGroupType":"网站","StartDate":"2016-11-24T17:17:05","EndDate":"2016-11-26T11:43:34","Status":0,"CreateTime":"2016-11-04T15:39:08","RuleGroupID":"c4fc8001-a261-11e6-8096-06fab88a43c3","TaskID":"113ef48a-a262-11e6-8096-06fab88a43c3"},{"SiteID":"1542","RuleGroupName":"测试规则组B","RuleGroupType":"网站","StartDate":"2016-11-24T17:17:05","EndDate":"2016-11-30T11:43:34","Status":0,"CreateTime":"2016-11-18T16:09:20","RuleGroupID":"ce2b4c10-cef0-4606-bfa0-d66dd7b37dac","TaskID":"23b6bf4c-8c83-4881-8a8d-1d635d5c0761"},{"SiteID":"1385","RuleGroupName":"试规则组A","RuleGroupType":"社会化媒体","StartDate":"2016-11-11T19:17:05","EndDate":"2016-12-12T17:17:05","Status":1,"CreateTime":"2016-11-22T11:17:31","RuleGroupID":"b671d837-f295-4710-8a3c-09b5dc60bc1e","TaskID":"269897b7-220a-4121-89e2-9200b1a31ba6"},{"SiteID":"1385","RuleGroupName":"测试规则组A","RuleGroupType":"网站","StartDate":"2016-11-21T15:39:37","EndDate":"2016-11-21T15:39:37","Status":3,"CreateTime":"2016-11-22T10:41:23","RuleGroupID":"39ad4c6b-591c-4529-8e69-04bf57ad9ce6","TaskID":"4f0f1fd7-ac47-48e9-acbe-813d522ec9a3"}];  
        }, 2000);  
      }
      

      

      $scope.columns = [
        {
          title: 'site ID/广告ID',
          template: '{{ row.SiteID }}'
        }, {
          title: '规则组名称',
          template: '{{ row.RuleGroupName }}'
        }, {
          title: '规则组类型',
          template: '{{ row.RuleGroupType }}'
        }, {
          title: '开始时间',
          template: '{{ row.StartDate | date2 }}'
        }, {
          title: '结束时间',
          template: '{{ row.EndDate | date2 }}'
        }, {
          title: '状态',
          template: '{{ handleStatus(row.Status) }}'
        }, {
          title: '任务进度',
          template: '<div class="text-center">22%</div>' +
            '<uib-progressbar value="22"></uib-progressbar>'
        }, {
          title: '创建时间',
          template: '{{ row.CreateTime | date2 }}'
        }, {
          title: '操作',
          template: '<a ui-sref="editTask({taskId: row.TaskID})">编辑任务时间</a>'
        }
      ];
      // 自定义的方法
      $scope.handleStatus = handleStatus;

      function handleStatus(status){
        return status + '状态';
      }

		}
	};
}

module.exports = directive;