controller.$inject = ['rulesService'];
function controller(rulesService){
  var $ctrl = this;

  $ctrl.rulesTitles = [
    { id: 0, title: '加入任务-未开启' },
    { id: 1, title: '加入任务-执行中' },
    { id: 2, title: '加入任务-暂停中' },
    { id: 3, title: '加入任务-已结束' },
    { id: 4, title: '未加入任务' }
  ];

  // ui-table配置
  var gridOptions = {
    enableColumnMenus: false, // 隐藏列菜单
    enableSorting: false, // 禁止排序
    columnDefs: [
      { field: 'SiteID', displayName: 'site ID/广告ID'},
      { field: 'RuleGroupName', displayName: '规则组名称'},
      { field: 'RuleGroupType', displayName: '规则组类型'},
      { 
        field: 'CreateTime', displayName: '创建时间',
        cellFilter: 'date:"yyyy-MM-dd hh:mm:ss"'
      },
      { 
        field: 'CreateTaskTime', displayName: '加入任务时间', 
        cellFilter: 'date:"yyyy-MM-dd hh:mm:ss"'
      },
      { 
        field: 'control', displayName: '',
        cellTemplate: 
          '<div class="ui-grid-cell-contents">' +
            '<a href="">复制规则组</a>' +
            '<br>' +
            '<a href="">导入规则组</a>' + 
          '</div>'
      }
    ]
  }; 

  $ctrl.gridOptions = $ctrl.rulesTitles.map(function(rules, index){
    getRules(rules.id, index);
    return Object.assign({}, gridOptions, {
      data: []
    });
  });

  function getRules(status, index){
    console.log(status, index);
    rulesService.getRules({ Status: status })
    .then(function(data){
      $ctrl.gridOptions[index].data = data && data.Data || [];
    });
  }



}

module.exports = {
  template: require('./rules-list.component.html'),
  controller: controller
};